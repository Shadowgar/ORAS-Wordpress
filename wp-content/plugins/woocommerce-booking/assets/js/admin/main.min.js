"undefined"!=typeof tyche&&"undefined"!=typeof bkap_params&&(tyche.extend(tyche.bkap,{ajax_url:function(){return bkap_params.ajax_url},rest_url:function(){return bkap_params.bkap_rest_url+"/"},return_view_label:function(param,label){return void 0!==param&&void 0!==param.label&&void 0!==param.label[label]?param.label[label]:"Error: Failed to fetch label data."},add_tool_tips_under_label_text:function(){let img=jQuery(".tm1-row img");img.length>0&&img.each(function(){let tool_tip=jQuery(this).attr("title");if(void 0!==tool_tip){if(""!==tool_tip){let parent=jQuery(this).parent().closest(".tm1-row").find(".col-left");0===parent.find("p").length&&parent.append(`<p class="tool-tip-text">${tool_tip}</p>`)}jQuery(this).parent().hasClass("rb1-left")?jQuery(this).parent().hide():jQuery(this).hide()}})},return_label:function(label,error_description=""){let _message=tyche.bkap.return_view_label(bkap_params.vue.label,label);return""!==error_description&&(_message=`${_message} <br/> <strong>Error Description: ${error_description}</strong>`),_message},is_object:function(item){return item&&"object"==typeof item&&!Array.isArray(item)},merge:function(target,source){if(tyche.bkap.is_object(target)&&tyche.bkap.is_object(source))for(const key in source)tyche.bkap.is_object(source[key])?(target[key]||Object.assign(target,{[key]:{}}),tyche.bkap.merge(target[key],source[key])):Object.assign(target,{[key]:source[key]});return target},event_listeners:function(){jQuery(document).on("click",".copy-to-clipboard",function(){let element_to_copy=jQuery(this).attr("data-selector-to-copy"),notification_msg=jQuery(this).attr("data-tip");jQuery(element_to_copy).select(),setTimeout(function(){document.execCommand("copy")&&tyche.bkap.notification(notification_msg,"success"),window.getSelection().removeAllRanges()},500)}),jQuery(document).on("click",".secondary-nav-wrap ul li",function(){tyche.bkap.add_tool_tips_under_label_text();let href=jQuery(this).find("a").attr("href");if("#/bulk-booking-settings"===href||"#/product-availability-settings"===href){let choice_instance="#/bulk-booking-settings"===href?tyche.bkap.choices_js.instances.bulk_booking_settings_selected_products_categories:tyche.bkap.choices_js.instances.product_availability_settings_selected_products;if(void 0===choice_instance)return;if(choice_instance.destroy(),"#/bulk-booking-settings"===href)return delete tyche.bkap.choices_js.instances.bulk_booking_settings_selected_products_categories,void tyche.bkap.choices_js.render_choices_js_elements("bulk_booking_settings_selected_products_categories",[],".bulk_booking_settings_selected_products_categories",!1,!1);if("#/product-availability-settings"===href)return delete tyche.bkap.choices_js.instances.product_availability_settings_selected_products,void tyche.bkap.choices_js.render_choices_js_elements("product_availability_settings_selected_products",[],".product_availability_settings_selected_products",!1,!1)}})},choices_js:{instances:[],render_choices_js_elements:function(index,value,class_name,is_search=!1,is_list=!1,choice_options={}){if(0!==jQuery(class_name).length){if(void 0===tyche.bkap.choices_js.instances[index]){let options={removeItemButton:!0,searchResultLimit:1e3,shouldSort:!1,noChoicesText:"No matches found"};is_search&&(options={searchResultLimit:1e3,placeholder:!0,loadingText:"Loading...",placeholderValue:"Type to begin search ...",searchPlaceholderValue:"Type to begin search ...",removeItemButton:!0,itemSelectText:"",searchEnabled:!0}),is_list&&(options={removeItemButton:!1,shouldSort:!1,removeItems:!1,searchEnabled:!1,allowHTML:!0,itemSelectText:""}),Object.keys(choice_options).length>0&&(options=choice_options),tyche.bkap.choices_js.instances[index]=new Choices(class_name,options)}if(is_search&&tyche.bkap.choices_js.instances[index].clearChoices(),void 0!==value&&value.length>0&&!is_list){let all_values=tyche.bkap.choices_js.instances[index].config.choices,record_found=!1,search_objects=[];value.forEach(function(_value){is_search&&search_objects.push({value:_value.value,label:_value.label,disabled:!1}),all_values.some(function(item){return _value===item.value})&&(record_found=!0,tyche.bkap.choices_js.instances[index].setChoiceByValue(_value))}),is_search&&search_objects.length>0&&tyche.bkap.choices_js.instances[index].setChoices(search_objects,"value","label",!1),!is_search&&!record_found&&value.length>0&&tyche.bkap.choices_js.instances[index].removeActiveItems()}else is_search||is_list||tyche.bkap.choices_js.instances[index].removeActiveItems()}}},notification:function(message,message_type){new AWN({position:"bottom-center",icons:{enabled:!1},maxNotifications:1,durations:{global:3e3},labels:{success:"",error:""}})[message_type](message)},alert:{error:function(title,message){alertify.errorAlert||alertify.dialog("errorAlert",function factory(){return{build:function(){this.setHeader(`<span class="fa fa-times-circle fa-2x" style="vertical-align:middle;color:#e10000;"></span> ${title}`)}}},!0,"alert"),alertify.errorAlert(message)}},confirm_dialog:function(title,body,onOk,onCancel,confirmOk="OK",confirmCancel="Cancel"){(new AWN).confirm(body,onOk,onCancel,{labels:{confirm:title,confirmOk:confirmOk,confirmCancel:confirmCancel}})},modal:function(content,close_btn_text,primary_btn_text,primary_btn_fn){const modal=new tingle.modal({footer:!0,stickyFooter:!0,closeMethods:[]});return modal.setContent(content),modal.addFooterBtn(close_btn_text,"tingle-btn tingle-btn--default",function(){modal.close()}),modal.addFooterBtn(primary_btn_text,"tingle-btn tingle-btn--primary",function(){primary_btn_fn()&&modal.close()}),modal.open(),modal},metabox:{booking:{timeout:{weekdays_dates_timeslots:{id:"",active:!1}},sidebar:{toggle_item:function(item,data){let _item="";if("object"==typeof data.sidebar.items){for(const prop in data.sidebar.items)!0===data.sidebar.items[prop]&&(_item=prop),data.sidebar.items[prop]=!1;if(""!==_item){let prev_settings=bkap_metabox_booking_param._data[_item],current_settings=data[_item];if(void 0!==data.is_bulk_booking||JSON.stringify(prev_settings)===JSON.stringify(current_settings))return void(void 0!==data.sidebar.items[item]&&(data.sidebar.items[item]=!0));tyche.bkap.confirm_dialog(data.label.unsaved_changes,data.label.unsaved_changes_description,function(){tyche.bkap.metabox.booking.save_settings(_item,data,function(status){"success"!==status||void 0===data.sidebar.items[item]?data.sidebar.items[_item]=!0:data.sidebar.items[item]=!0})},function(){data[_item]=window.bkap_metabox_booking_param._data[_item],window.bkap_metabox_booking_param._data[_item]=JSON.parse(JSON.stringify(data[_item])),void 0!==data.sidebar.items[item]&&(data.sidebar.items[item]=!0)},"Save Changes","Discard Changes")}}}},only_numbers:function(event){event.keyCode>=48&&event.keyCode<=57||event.keyCode>=96&&event.keyCode<=105||(event.target.value=event.target.value.replace(event.key,""))},only_numbers_and_decimals:function(event,row=""){event.keyCode>=48&&event.keyCode<=57||(190===event.keyCode||110===event.keyCode)&&2===event.target.value.split(".").length||event.keyCode>=96&&event.keyCode<=105||(event.target.value=event.target.value.replace(event.key,""));let model=jQuery(event.target).attr("data-model");""!==row&&void 0!==model&&""!==model&&(row[model]=event.target.value)},availability_dates_months:{handle_option_change_range_type:function(index,data){range_type=data.availability.settings.data.availability[index].range_type,"custom_range"!==range_type&&"holidays"!==range_type||(data.availability.settings.data.availability[index].bookable=""),"specific_dates"!==range_type&&"range_of_months"!==range_type||(data.availability.settings.data.availability[index].bookable="on")},add_row:function(data){data.availability.settings.data.availability.push({edit:!0,is_editable:!1,range_type:"custom_range",custom_range_from:"",custom_range_to:"",custom_range_number_of_years:"",bookable:"",specific_dates_date:"",holidays_date:"",specific_dates_max_bookings:"",specific_dates_price:"",range_of_months_number_of_years:"",holidays_number_of_years:"",range_of_months_from:"",range_of_months_to:""})},update_row:function(row,index,data){row.edit=!1,data.toggle_edit_mode.weekday_availability=!1},edit_row:function(row,index,data){row.edit=!0,data.toggle_edit_mode.weekday_availability=!0},delete_row:function(row,index,data){if(!row.is_editable)return void data.availability.settings.data.availability.splice(index,1);data.loader.loader_deleting_timeslots=!0;let _data={product_id:data.product_id,is_bookable:row.bookable,range_type:row.range_type};switch(row.range_type){case"custom_range":_data.start=row.custom_range_from,_data.end=row.custom_range_to;break;case"specific_dates":_data.start=row.specific_dates_date;break;case"range_of_months":_data.start=row.range_of_months_from,_data.end=row.range_of_months_to;break;case"holidays":_data.start=row.holidays_date}axios.post(`${tyche.bkap.rest_url()}metabox/booking/availability/delete`,{data:_data},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(tyche.bkap.notification(response.data.message,"success"),data.availability.settings.data.availability.splice(index,1),data.loader.loader_deleting_timeslots=!1):"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),data.loader.loader_deleting_timeslots=!1):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),data.loader.loader_deleting_timeslots=!1)}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),data.loader.loader_deleting_timeslots=!1}),document.getElementById("booking-metabox").scrollIntoView({behavior:"smooth",block:"start"})}},weekdays_dates_timeslots:{add_timeslot:function(data){data.availability.settings.data.weekdays_dates_timeslots.push({edit:!0,global:"",from:"",to:"",lockout:"",price:"",note:"",weekday:[],is_new_row:!0}),setTimeout(function(){jQuery(".bkap_choices_js_weekdays_dates_timeslots_weekday").each(function(){let id=jQuery(this).attr("id");tyche.bkap.choices_js.render_choices_js_elements(id,data.settings.weekdays_dates_timeslots_weekday,`#${id}`,!1,!0,{removeItemButton:!0,shouldSort:!1,itemSelectText:""})})},50)},update_row:function(row,index,data){""!==row.from&&(""!==row.to&&parseInt(row.from.replace(":",""))>parseInt(row.to.replace(":",""))?alert(data.settings.validation_messages.weekday_timeslot_validation):row.is_editable&&(data.loader.loader_updating_timeslots=!0,axios.post(`${tyche.bkap.rest_url()}metabox/booking/weekdays-dates-timeslots/update`,{data:{current:row,former:data.availability.settings.data.weekdays_dates_timeslots[index].og_data,product_id:data.product_id}},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(tyche.bkap.notification(response.data.message,"success"),row.edit=!1,data.availability.settings.data.weekdays_dates_timeslots[index].og_data={from:row.from,global:row.global,lockout:row.lockout,note:row.note,price:row.price,to:row.to,weekday:row.weekday},data.toggle_edit_mode.weekdays_dates_timeslots=!1,data.loader.loader_updating_timeslots=!1):"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),data.loader.loader_updating_timeslots=!1):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),data.loader.loader_updating_timeslots=!1)}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),data.loader.loader_updating_timeslots=!1})))},edit_row:function(row,index,data){row.edit=!0,"0:00"!=row.to&&"00:00"!=row.to||(row.to=""),data.toggle_edit_mode.weekdays_dates_timeslots=!0,row.is_editable},delete_row:function(row,index,data){row.is_editable?confirm(data.settings.confirmation_messages.delete_timeslot)&&(data.loader.loader_deleting_timeslots=!0,row.product_id=data.product_id,axios.post(`${tyche.bkap.rest_url()}metabox/booking/weekdays-dates-timeslots/delete`,{data:row},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(tyche.bkap.notification(response.data.message,"success"),data.availability.settings.data.weekdays_dates_timeslots.splice(index,1),data.loader.loader_deleting_timeslots=!1):"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),data.loader.loader_deleting_timeslots=!1):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),data.loader.loader_deleting_timeslots=!1)}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),data.loader.loader_deleting_timeslots=!1})):data.availability.settings.data.weekdays_dates_timeslots.splice(index,1)},delete_all_timeslots:function(data){confirm(data.settings.confirmation_messages.delete_all_timeslots)&&0!==data.availability.settings.data.weekdays_dates_timeslots.length&&(data.loader.loader_deleting_all_timeslots=!0,axios.post(`${tyche.bkap.rest_url()}metabox/booking/weekdays-dates-timeslots/delete-all`,{data:{product_id:data.product_id}},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(tyche.bkap.notification(response.data.message,"success"),data.availability.settings.data.weekdays_dates_timeslots.splice(0,data.availability.settings.data.weekdays_dates_timeslots.length),data.loader.loader_deleting_all_timeslots=!1):"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),data.loader.loader_deleting_all_timeslots=!1):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),data.loader.loader_deleting_all_timeslots=!1)}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),data.loader.loader_deleting_all_timeslots=!1}))}},block_pricing:{fixed_block:{add_row:function(data){data.block_pricing.settings.data.fixed_block.push({edit:!0,block_name:"",number_of_days:"",start_day:"any_days",end_day:"any_days",price:"",is_new_row:!0})},edit_row:function(row,index,data){row.edit=!0,data.toggle_edit_mode.block_pricing_fixed_block=!0},delete_row:function(row,index,data){row.is_new_row?data.block_pricing.settings.data.fixed_block.splice(index,1):confirm(data.settings.confirmation_messages.delete_fixed_block)&&(data.loader.loader_deleting_fixed_block_data=!0,axios.post(`${tyche.bkap.rest_url()}metabox/booking/block-pricing/fixed-block/delete`,{data:{product_id:data.product_id,index:index}},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(tyche.bkap.notification(response.data.message,"success"),data.block_pricing.settings.data.fixed_block.splice(index,1),data.loader.loader_deleting_fixed_block_data=!1):"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),data.loader.loader_deleting_fixed_block_data=!1):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),data.loader.loader_deleting_fixed_block_data=!1)}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),data.loader.loader_deleting_fixed_block_data=!1}))},delete_all_rows:function(data){confirm(data.settings.confirmation_messages.delete_all_fixed_blocks)&&0!==data.block_pricing.settings.data.fixed_block.length&&(data.loader.loader_deleting_all_fixed_block_data=!0,axios.post(`${tyche.bkap.rest_url()}metabox/booking/block-pricing/fixed-block/delete-all`,{data:{product_id:data.product_id}},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(tyche.bkap.notification(response.data.message,"success"),data.block_pricing.settings.data.fixed_block.splice(0,data.block_pricing.settings.data.fixed_block.length),data.loader.loader_deleting_all_fixed_block_data=!1):"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),data.loader.loader_deleting_all_fixed_block_data=!1):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),data.loader.loader_deleting_all_fixed_block_data=!1)}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),data.loader.loader_deleting_all_fixed_block_data=!1}))}},price_by_range_of_nights:{add_row:function(data){let _data={edit:!0,min_number:"",max_number:"",per_day_price:"",fixed_price:"",is_new_row:!0};if(tyche.bkap.is_object(data.block_pricing.settings.product_attributes)&&Object.keys(data.block_pricing.settings.product_attributes).length>0)for(var key in data.block_pricing.settings.product_attributes)data.block_pricing.settings.product_attributes.hasOwnProperty(key)&&(_data[key]=data.settings.block_pricing_variable_product_attributes[key][0]);data.block_pricing.settings.data.price_by_range_of_nights.push(_data)},edit_row:function(row,index,data){row.edit=!0,data.toggle_edit_mode.block_pricing_price_by_range=!0},delete_row:function(row,index,data){row.is_new_row?data.block_pricing.settings.data.price_by_range_of_nights.splice(index,1):confirm(data.settings.confirmation_messages.delete_price_range)&&(data.loader.loader_deleting_price_range_by_months_data=!0,axios.post(`${tyche.bkap.rest_url()}metabox/booking/block-pricing/price-range-by-nights/delete`,{data:{product_id:data.product_id,index:index}},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(tyche.bkap.notification(response.data.message,"success"),data.block_pricing.settings.data.price_by_range_of_nights.splice(index,1),data.loader.loader_deleting_price_range_by_months_data=!1):"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),data.loader.loader_deleting_price_range_by_months_data=!1):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),data.loader.loader_deleting_price_range_by_months_data=!1)}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),data.loader.loader_deleting_price_range_by_months_data=!1}))},delete_all_rows:function(data){confirm(data.settings.confirmation_messages.delete_all_price_ranges)&&0!==data.block_pricing.settings.data.price_by_range_of_nights.length&&(data.loader.loader_deleting_all_price_range_by_months_data=!0,axios.post(`${tyche.bkap.rest_url()}metabox/booking/block-pricing/price-range-by-nights/delete-all`,{data:{product_id:data.product_id}},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(tyche.bkap.notification(response.data.message,"success"),data.block_pricing.settings.data.price_by_range_of_nights.splice(0,data.block_pricing.settings.data.price_by_range_of_nights.length),data.loader.loader_deleting_all_price_range_by_months_data=!1):"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),data.loader.loader_deleting_all_price_range_by_months_data=!1):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),data.loader.loader_deleting_all_price_range_by_months_data=!1)}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),data.loader.loader_deleting_all_price_range_by_months_data=!1}))}},clear_block_selection:function(data){data.block_pricing.settings.block_pricing_type=""}},persons:{add_row:function(data){data.persons.settings.data.person_settings.push({edit:!0,person_id:"",person_title:"",base_cost:0,block_cost:0,person_min:0,person_max:1,person_desc:"",is_new_row:!0})},edit_row:function(row,index,data){row.edit=!0,data.toggle_edit_mode.persons_person_type=!0},delete_row:function(row,index,data){row.is_new_row?data.persons.settings.data.person_settings.splice(index,1):confirm(data.settings.confirmation_messages.delete_person)&&(data.loader.loader_deleting_person_data=!0,axios.post(`${tyche.bkap.rest_url()}metabox/booking/person/delete`,{data:{product_id:data.product_id,id:row.person_id}},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(tyche.bkap.notification(response.data.message,"success"),data.persons.settings.data.person_settings.splice(index,1),data.loader.loader_deleting_person_data=!1):"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),data.loader.loader_deleting_person_data=!1):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),data.loader.loader_deleting_person_data=!1)}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),data.loader.loader_deleting_person_data=!1}))},delete_all_rows:function(data){confirm(data.settings.confirmation_messages.delete_all_persons)&&0!==data.persons.settings.data.person_settings.length&&(data.loader.loader_deleting_all_person_data=!0,axios.post(`${tyche.bkap.rest_url()}metabox/booking/person/delete-all`,{data:{product_id:data.product_id}},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(tyche.bkap.notification(response.data.message,"success"),data.persons.settings.data.person_settings.splice(0,data.persons.settings.data.person_settings.length),data.loader.loader_deleting_all_person_data=!1):"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),data.loader.loader_deleting_all_person_data=!1):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),data.loader.loader_deleting_all_person_data=!1)}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),data.loader.loader_deleting_all_person_data=!1}))}},resources:{add_row:function(data){data.resources.settings.data.resource_settings.push({edit:!0,is_new_row:!0,resource_id:"",resource_title:"",base_cost:""})},edit_row:function(row,index,data){row.edit=!0,data.toggle_edit_mode.resource_settings=!0},delete_row:function(row,index,data){row.is_new_row?data.resources.settings.data.resource_settings.splice(index,1):confirm(data.settings.confirmation_messages.delete_resource)&&(data.loader.loader_deleting_resource_data=!0,axios.post(`${tyche.bkap.rest_url()}metabox/booking/resource/delete`,{data:{product_id:data.product_id,id:row.resource_id}},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(tyche.bkap.notification(response.data.message,"success"),data.resources.settings.data.resource_settings.splice(index,1),data.loader.loader_deleting_resource_data=!1):"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),data.loader.loader_deleting_resource_data=!1):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),data.loader.loader_deleting_resource_data=!1)}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),data.loader.loader_deleting_resource_data=!1}))},delete_all_rows:function(data){confirm(data.settings.confirmation_messages.delete_all_resources)&&0!==data.resources.settings.data.resource_settings.length&&(data.loader.loader_deleting_all_resource_data=!0,axios.post(`${tyche.bkap.rest_url()}metabox/booking/resource/delete-all`,{data:{product_id:data.product_id}},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(tyche.bkap.notification(response.data.message,"success"),data.resources.settings.data.resource_settings.splice(0,data.resources.settings.data.resource_settings.length),data.loader.loader_deleting_all_resource_data=!1):"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),data.loader.loader_deleting_all_resource_data=!1):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),data.loader.loader_deleting_all_resource_data=!1)}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),data.loader.loader_deleting_all_resource_data=!1}))}},integrations:{toggle_display(e,data){void 0!==data.toggle_integrations.google_calendar_integration_mode[e]&&(data.toggle_integrations.google_calendar_integration_mode[e]=!data.toggle_integrations.google_calendar_integration_mode[e])},reset(data){let $this=data.toggle_integrations.google_calendar_integration_mode;$this.show_saved_message=!1,$this.show_logout_from_calendar_loader=!1,$this.test_connection_message="",$this.show_instructions_import_events=!1,$this.show_imported_success_message=!1,$this.ics_url_message="",$this.show_imported_error_message=!1,$this.show_inline_loader_gcal=!1,$this.show_ics_url_message=!1},logout_from_google_calendar(data){tyche.bkap.metabox.booking.integrations.reset(data);let loader=data.toggle_integrations.google_calendar_integration_mode;loader.show_logout_from_calendar_loader=!0,axios.post(`${tyche.bkap.rest_url()}google-calendar/logout-google-calendar`,{product_id:data.product_id},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data.type&&"success"===response.data.type?(tyche.bkap.notification(response.data.message,"success"),loader.show_logout_from_calendar_loader=!1):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),loader.show_logout_from_calendar_loader=!1)}).catch(function(){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),loader.show_logout_from_calendar_loader=!1})},handle_file_change(event,data){let $this=data.toggle_integrations.google_calendar_integration_mode;const file=event.target.files[0];if(file&&"application/json"===file.type){const reader=new FileReader;reader.onload=()=>{void 0!==JSON.parse(reader.result).private_key&&(data.json_file_data={bkap_calendar_json_data:reader.result,product_id:0,name:file.name})},reader.readAsText(file)}else $this.json_file_upload_message="Invalid file. Please upload JSON File.",setInterval(()=>{$this.json_file_upload_message=""},3e3)},upload_json(data){$this=data.toggle_integrations.google_calendar_integration_mode,_.isEmpty(data.json_file_data)?($this.json_file_upload_message="Please upload the JSON File.",setInterval(()=>{$this.json_file_upload_message=""},3e3)):axios.post(`${tyche.bkap.rest_url()}google-calendar/save-json`,{bkap_calendar_json_data:data.json_file_data.bkap_calendar_json_data,product_id:data.product_id,name:data.json_file_data.name},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data.type&&"success"===response.data.type?(data.integrations.settings.bkap_calendar_directly_integration.json_file_name=response.data.bkap_calendar_json_file_name,data.integrations.settings.bkap_calendar_directly_integration.json_data=data.json_file_data.bkap_calendar_json_data,data.integrations.settings.bkap_calendar_directly_integration.email_address=response.data.bkap_calendar_service_acc_email_address,$this.json_file_upload_message=response.data.message):$this.json_file_upload_message=response.data.error_description,setInterval(()=>{$this.json_file_upload_message=""},3e3)}).catch(function(error){$this.json_file_upload_message=tyche.bkap.return_label("axios_get_error",error),$this.show_inline_loader_gcal=!1,setInterval(()=>{$this.json_file_upload_message=""},3e3)})},remove_json(data){$this=data.toggle_integrations.google_calendar_integration_mode,axios.post(`${tyche.bkap.rest_url()}google-calendar/remove-json`,{product_id:data.product_id},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data.type&&"success"===response.data.type?(data.integrations.settings.bkap_calendar_directly_integration.json_file_name="",data.integrations.settings.bkap_calendar_directly_integration.email_address="",data.integrations.settings.bkap_calendar_directly_integration.json_data={},data.json_file_data={},$this.json_file_upload_message=response.data.message):$this.json_file_upload_message=response.data.error_description,setInterval(()=>{$this.json_file_upload_message=""},3e3)}).catch(function(error){$this.json_file_upload_message=tyche.bkap.return_label("axios_get_error",error),setInterval(()=>{$this.json_file_upload_message=""},3e3)})},test_gcal_connection(data){tyche.bkap.metabox.booking.integrations.reset(data);let $this=data.toggle_integrations.google_calendar_integration_mode;$this.show_inline_loader_gcal=!0;let bdata={};void 0!==typeof data.product&&(bdata={product_id:data.product_id}),axios.post(`${tyche.bkap.rest_url()}google-calendar/test-connection`,bdata,{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data.type&&"success"===response.data.type?($this.show_inline_loader_gcal=!1,$this.test_connection_message=response.data.message):($this.test_connection_message=tyche.bkap.return_label("axios_get_error"),$this.show_inline_loader_gcal=!1)}).catch(function(error){$this.test_connection_message=tyche.bkap.return_label("axios_get_error",error),$this.show_inline_loader_gcal=!1})},save_ics_url(row,data,action=""){tyche.bkap.metabox.booking.integrations.reset(data);let $this=data.toggle_integrations.google_calendar_integration_mode;if(""===row.url)return $this.show_ics_url_message=!0,void($this.ics_url_message=bkap_metabox_booking_param.label.ics_url_is_empty_message);axios.post(`${tyche.bkap.rest_url()}google-calendar/save-ics-urls`,{ics_urls:data.integrations.settings.bkap_ics_feed_urls,product_id:data.product_id},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){if(void 0!==response.data.type&&"success"===response.data.type){let urls=response.data.bkap_ics_feed_urls;Array.isArray(urls)&&urls.length>0&&(data.settings.bkap_ics_feed_urls=urls),""===action&&($this.show_ics_url_message=!0,$this.ics_url_message=bkap_metabox_booking_param.label.save_ics_url_success_message)}else $this.ics_url_message=tyche.bkap.return_label("axios_get_error"),$this.show_ics_url_message=!0}).catch(function(error){$this.ics_url_message=tyche.bkap.return_label("axios_get_error",error),$this.show_ics_url_message=!1})},import_ics_event(id,data){tyche.bkap.metabox.booking.integrations.reset(data);let $this=data.toggle_integrations.google_calendar_integration_mode;data.integrations.settings.bkap_ics_feed_urls[id].is_importing=!0,axios.post(`${tyche.bkap.rest_url()}google-calendar/import-event`,{id:id,product_id:data.product_id},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data.type&&"success"===response.data.type?($this.show_imported_success_message=!0,data.integrations.settings.bkap_ics_feed_urls[id].save=!1,data.integrations.settings.bkap_ics_feed_urls[id].import=!1,data.integrations.settings.bkap_ics_feed_urls[id].delete=!0,data.integrations.settings.bkap_ics_feed_urls[id].is_importing=!1):($this.show_imported_error_message=!0,data.integrations.settings.bkap_ics_feed_urls[id].is_importing=!1)}).catch(function(){$this.show_imported_error_message=!0,data.integrations.settings.bkap_ics_feed_urls[id].is_importing=!1})},delete_ics_url(row,id,data){let url=row.url;data.integrations.settings.bkap_ics_feed_urls.splice(id,1),""!==url&&tyche.bkap.metabox.booking.integrations.save_ics_url(row,data,"delete")},add_new_ics_url(data){data.integrations.settings.bkap_ics_feed_urls.push({url:"",save:!0,import:!1,delete:!0,is_importing:!1})}},manage_availability:{add_row:function(data){data.availability.settings.data.manage_availability.push({edit:!0,is_editable:!1,range_type:"custom",range_days_from:"1",range_days_to:"2",range_months_from:"1",range_months_to:"2",range_weeks_from:"1",range_weeks_to:"2",range_date_from:"",range_date_to:"",range_time_from:"",range_time_to:"",range_time_range_date_from:"",range_time_range_date_to:"",range_time_range_time_from:"",range_time_range_time_to:"",priority:10,bookable:""})},update_row:function(row,index,data){row.edit=!1,data.toggle_edit_mode.manage_availability=!1,tyche.bkap.metabox.booking.save_settings("availability",data)},edit_row:function(row,index,data){row.edit=!0,data.toggle_edit_mode.manage_availability=!0},delete_row:function(row,index,data){data.availability.settings.data.manage_availability.splice(index,1),tyche.bkap.metabox.booking.save_settings("availability",data)}},seasonal_pricing:{reset_season_data(data){data.seasonal_pricing.add_season_data={amount_or_percent:"percent",operator:"add",season_name:"",user_role:[],start_date:"",end_date:"",price:"",years:1}},show_add_season_page(data){data.seasonal_pricing.show_add_season_data_page=!0,setTimeout(()=>{tyche.bkap.choices_js.render_choices_js_elements("user_role",data.settings.wp_roles,".bkap_choices_js_user_role")})},show_edit_season_page(index,data){data.seasonal_pricing.add_season_data=data.seasonal_pricing.seasons_configuration_data[index],data.seasonal_pricing.add_season_data.is_edit=!0,data.seasonal_pricing.add_season_data.id=index,data.fn.seasonal_pricing.show_add_season_page(data),setTimeout(()=>{"object"==typeof data.seasonal_pricing.add_season_data.user_role&&null!==data.seasonal_pricing.add_season_data.user_role&&data.seasonal_pricing.add_season_data.user_role.forEach(key=>{tyche.bkap.choices_js.instances.user_role.setChoiceByValue(key)})})},hide_add_season_page(data){data.seasonal_pricing.show_add_season_data_page=!1,data.fn.seasonal_pricing.reset_season_data(data)},delete_season_data(index,data,product_id=0){jQuery(`#deleteModal_${index}`).modal("hide"),data.loader.loader_saving_seasonal_pricing_settings=!0,axios.post(`${tyche.bkap.rest_url()}seasonal-pricing/delete-season-data`,{id:index,product_id:product_id},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data&&("success"===response.data.type?(data.seasonal_pricing.seasons_configuration_data=response.data.seasons_configuration_data,data.seasonal_pricing.show_add_season_data_page=!1,data.loader.loader_saving_seasonal_pricing_settings=!1,data.fn.seasonal_pricing.reset_season_data(data)):response.data.type)}).catch(function(error){})},save_season_data(data){var season_error_msg="";if(""==data.seasonal_pricing.add_season_data.season_name&&(season_error_msg+="<br>Season name value is empty."),""==data.seasonal_pricing.add_season_data.start_date&&(season_error_msg+="<br>Start date value is empty."),""==data.seasonal_pricing.add_season_data.end_date&&(season_error_msg+="<br>End date value is empty."),""==data.seasonal_pricing.add_season_data.price&&(season_error_msg+="<br>Amount/Percent value is empty."),""!==season_error_msg)return tyche.bkap.alert.error("Some errors have been found!",season_error_msg),!1;data.loader.loader_saving_seasonal_pricing_settings=!0,data.seasonal_pricing.show_add_season_data_page=!0,data.seasonal_pricing.add_season_data.is_edit,axios.post(`${tyche.bkap.rest_url()}seasonal-pricing/save-season-data`,{season_data:data.seasonal_pricing.add_season_data,product_id:data.product_id},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data&&("success"===response.data.type?(data.seasonal_pricing.seasons_configuration_data=response.data.seasons_configuration_data,data.seasonal_pricing.show_add_season_data_page=!1,data.loader.loader_saving_seasonal_pricing_settings=!1,data.fn.seasonal_pricing.reset_season_data(data)):response.data.type)}).catch(function(error){})}},validate_timeslot_input:function(input1,input2,element,errorMsg){if(void 0!==input1&&void 0!==input2){if(element=jQuery(`#${element}`),parseInt(input1.replace(":",""))>parseInt(input2.replace(":",""))&&0===element.parent().find(".wc_error_tip").length)return element.after(`<div class="wc_error_tip">${errorMsg}</div>`),void element.parent().find(".wc_error_tip").fadeIn("100");element.parent().find(".wc_error_tip").fadeOut("100",function(){jQuery(this).remove()})}},validate_weekday_date_timeslots_from_or_to:function(event,input1,input2,element,errorMsg){event.target.value=event.target.value.replace(/[^0-9:]/g,""),""!==tyche.bkap.metabox.booking.timeout.weekdays_dates_timeslots.id&&clearTimeout(tyche.bkap.metabox.booking.timeout.weekdays_dates_timeslots.id),tyche.bkap.metabox.booking.timeout.weekdays_dates_timeslots.id=setTimeout(function(){if(!1===/^([0-1][0-9]|[2][0-3]):([0-5][0-9])$/.test(event.target.value))return event.target.value="",void(tyche.bkap.metabox.booking.timeout.weekdays_dates_timeslots.id="")},2500),tyche.bkap.metabox.booking.validate_timeslot_input(input1,input2,element,errorMsg)},validate_field:function(event,compare_value,field_name=""){!isNaN(event.target.valueAsNumber)&&(""!==event.target.value?parseInt(event.target.value):0)<compare_value&&(alert(`${field_name} cannot be less than ${compare_value} !`),event.target.value=compare_value)},save_settings:function(section,data,func=null){const is_save_all="save_all"===section,is_bulk_booking=void 0!==data.is_bulk_booking;if(!is_save_all&&(void 0===data[section]||void 0===data[section].settings))return;if(!tyche.bkap.metabox.booking.perform_validation(section,data))return;is_save_all||(data.loader[`loader_saving_${section}_settings`]=!0),is_bulk_booking&&(document.getElementById("bkap-page").scrollIntoView({behavior:"smooth",block:"start"}),data.loader.loader_saving_bulk_booking_settings=!0);let $data={};is_save_all&&($data={is_save_all:!0,save_all_data:{general:data.general.settings,availability:data.availability.settings,block_pricing:data.block_pricing.settings,persons:data.persons.settings,resources:data.resources.settings,integrations:data.integrations.settings,rental:data.rental.settings,partial_payments:data.partial_payments.settings,seasonal_pricing:data.seasonal_pricing.settings},save_settings_as_default:void 0!==data.save_selected_options_as_default_options?data.save_selected_options_as_default_options:""}),is_save_all||($data=data[section].settings),setTimeout(function(){axios.post(`${tyche.bkap.rest_url()}${is_bulk_booking?"bulk-booking-settings/save":"metabox/booking/save"}`,{data:$data,product_id:data.product_id},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){if(void 0!==response.data){if("success"===response.data.type)void 0!==response.data.data&&(window.bkap_metabox_booking_param._data=JSON.parse(JSON.stringify(response.data.data))),is_save_all||(tyche.bkap.notification(response.data.message,"success"),data.general=response.data.data.general,data.availability=response.data.data.availability,data.block_pricing=response.data.data.block_pricing,data.persons=response.data.data.persons,data.resources=response.data.data.resources,data.integrations=response.data.data.integrations,data.settings=response.data.data.settings,data.rental=response.data.data.rental,data.partial_payments=response.data.data.partial_payments,data.seasonal_pricing=response.data.data.seasonal_pricing,data.loader[`loader_saving_${section}_settings`]=!1),is_bulk_booking&&(response.data.save_settings_as_default&&(data.is_exist_default_booking_settings=!0),void 0!==response.data.is_bulk_booking?setTimeout(function(){window.location.reload()},4e3):data.loader.loader_saving_bulk_booking_settings=!1,tyche.bkap.notification(response.data.message,"success"),tyche.bkap.choices_js.instances.bulk_booking_settings_selected_products_categories.removeActiveItems(),data.product_id=[]),null!==func&&"function"==typeof func&&func("success");else if("error"===response.data.type){if(is_save_all&&!is_bulk_booking)return void alert(response.data.error_description);is_bulk_booking?data.loader.loader_saving_bulk_booking_settings=!1:data.loader[`loader_saving_${section}_settings`]=!1,tyche.bkap.notification(response.data.error_description,"alert"),null!==func&&"function"==typeof func&&func("error")}}else{if(is_save_all&&!is_bulk_booking)return void alert(tyche.bkap.return_label("axios_get_error"));is_bulk_booking?data.loader.loader_saving_bulk_booking_settings=!1:data.loader[`loader_saving_${section}_settings`]=!1,tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),null!==func&&"function"==typeof func&&func("error")}}).catch(function(error){!is_save_all||is_bulk_booking?(is_bulk_booking?data.loader.loader_saving_bulk_booking_settings=!1:data.loader[`loader_saving_${section}_settings`]=!1,tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),null!==func&&"function"==typeof func&&func("error")):alert(tyche.bkap.return_label("axios_get_error"))})},100)},fix_loader_alignment:function(){jQuery(document).ready(function(){let div_booking_metabox=jQuery("#booking-metabox"),div_bkap_admin_loader_wrapper=jQuery(".bkap_admin_loader_wrapper"),div_booking_metabox_width=div_booking_metabox.width(),div_booking_metabox_height=div_booking_metabox.height();0===div_booking_metabox_width&&"none"===div_booking_metabox.parent().css("display")&&(div_booking_metabox.parent().css("display","block"),div_booking_metabox_width=div_booking_metabox.width(),div_booking_metabox_height=div_booking_metabox.height(),div_booking_metabox.parent().css("display","none")),div_bkap_admin_loader_wrapper.width(div_booking_metabox_width-150),div_bkap_admin_loader_wrapper.css("max-width",div_booking_metabox_width-150),div_bkap_admin_loader_wrapper.css("top",div_booking_metabox_height/2-div_bkap_admin_loader_wrapper.height()-50+"px"),div_bkap_admin_loader_wrapper.css("left","75px"),div_bkap_admin_loader_wrapper.css("text-align","center")})},initialize_datepicker:function(e,_options="",row="",data=""){let target="string"==typeof e?e:e.target,options=""===_options?{minDate:new Date,dateFormat:"d-m-yyyy",multiSelect:100,monthsToShow:1,multiSeperator:","}:Array.isArray(_options)?Object.assign({},_options):_options;""!==row&&""!==data&&(options.onSelect=function(){let model=jQuery(target).attr("data-model"),dates=jQuery(target).val();if(row[model]=dates,"specific_dates_date"===model||"holidays_date"===model){let _dates=dates.split(",");_dates.forEach(function(item){void 0===data.settings.weekdays_dates_timeslots_weekday[item]&&(data.settings.weekdays_dates_timeslots_weekday[item]=item)});for(const key in data.settings.weekdays_dates_timeslots_weekday)if(-1!==data.settings.weekdays_dates_timeslots_weekday[key].indexOf("-")&&!_dates.includes(data.settings.weekdays_dates_timeslots_weekday[key])){for(const _key in tyche.bkap.choices_js.instances)-1!==_key.indexOf("bkap_choices_js_weekdays_dates_timeslots_weekday")&&tyche.bkap.choices_js.instances[_key].config.choices.forEach(function(element,index){element.value===key&&tyche.bkap.choices_js.instances[_key].config.choices.splice(index,1)});Vue.delete(data.settings.weekdays_dates_timeslots_weekday,key)}}});let language="",type="single";if(void 0!==options.bkap_language&&(language=options.bkap_language,delete options.bkap_language),void 0!==options.bkap_type&&(type=options.bkap_type,delete options.bkap_type),void 0!==options.addDates&&(options.addDates=JSON.parse(options.addDates)),"single"===type)jQuery(target).datepick(options);else{if("multiple"!==type)return;jQuery(target).multiDatesPicker(options)}""!==language&&jQuery(target).datepicker(jQuery.datepicker.regional[language]),jQuery(".ui-datepicker-inline").css("font-size","1.4em"),jQuery(target).focus()},event_listeners:function(){jQuery(document).on("click","#bkap_booking_metabox_collapse_sidebar",function(){if(jQuery(".col-sidebar").hasClass("collapse-sidebar"))return jQuery(".col-sidebar").removeClass("collapse-sidebar"),jQuery("div#booking-metabox .tbl-mod-1 .tm1-row .col-left.col-left-sidebar").css({"max-width":"25%",width:"unset"}),void jQuery("div#booking-metabox .tbl-mod-1 .tm1-row .col-right.col-right-sidebar").css({"max-width":"75%"});jQuery(".col-sidebar").addClass("collapse-sidebar"),jQuery("div#booking-metabox .tbl-mod-1 .tm1-row .col-left.col-left-sidebar").css({"max-width":"70px",width:"70px"}),jQuery("div#booking-metabox .tbl-mod-1 .tm1-row .col-right.col-right-sidebar").css({"max-width":"calc(100% - 70px)"})}),jQuery(document).on("click","#publish, #save-post",function(e){tyche.bkap.metabox.booking.save_settings("save_all",$this.data)})},perform_validation:function(section,data){let error_msg="";if("block_pricing"===section||"save_all"===section){let msg="",block_prices=data.block_pricing.settings.data.fixed_block;Array.isArray(block_prices)&&0!==block_prices.length&&(block_prices.forEach(function(element,index){void 0!==element.block_name&&""!==element.block_name||(msg+=`<br/><br/>Error found in Row: ${index+1}:<br/>Block Name is empty.`),void 0!==element.number_of_days&&""!==element.number_of_days||(msg+=`<br/><br/>Error found in Row: ${index+1}:<br/>Number of Days is empty.`),void 0!==element.price&&""!==element.price||(msg+=`<br/><br/>Error found in Row: ${index+1}:<br/>Price is empty.`)}),""!==msg&&(error_msg+=`<br/> == FIXED BLOCK PRICING == ${msg}`)),msg="";let range_of_nights=data.block_pricing.settings.data.price_by_range_of_nights;Array.isArray(range_of_nights)&&0!==range_of_nights.length&&(range_of_nights.forEach(function(element,index){void 0!==element.min_number&&""!==element.min_number||(msg+=`<br/><br/>Error found in Row: ${index+1}:<br/>Minimum Day value is empty.`),void 0!==element.max_number&&""!==element.max_number||(msg+=`<br/><br/>Error found in Row: ${index+1}:<br/>Maximum Day value is empty.`),""===element.min_number&&""===element.max_number&&parseInt(element.max_number)<parseInt(element.min_number)&&(msg+=`<br/><br/> Error found in Row: ${index+1}:<br/>Minimum day value must be less than the Maximum day value.`),void 0!==element.per_day_price&&""!==element.per_day_price||void 0!==element.fixed_price&&""!==element.fixed_price||void 0!==element.fixed_price&&""!==element.fixed_price||(msg+=`<br/><br/>Error found in Row: ${index+1}:<br/>Price is empty.`)}),""!==msg&&(error_msg+=`<br/> == PRICE BY RANGE OF NIGHTS == ${msg}`))}return"save_all"===section&&void 0!==data.is_bulk_booking&&(!Array.isArray(data.product_id)||Array.isArray(data.product_id)&&0===data.product_id.length)&&(error_msg+="<br/> == BULK BOOKING SETTINGS == <br/><br/>Please select a Product."),""===error_msg||(tyche.bkap.alert.error("Some errors have been found!",error_msg),!1)},clear_default_settings:function(section,data){data.show_clear_settings_loader=!0,axios.post(`${tyche.bkap.rest_url()}bulk-booking-settings/clear-default-settings`,{},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(tyche.bkap.notification(response.data.message,"success"),data.show_clear_settings_loader=!1,data.is_exist_default_booking_settings=!1):"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),data.show_clear_settings_loader=!1):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),data.show_clear_settings_loader=!1)}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),data.show_clear_settings_loader=!1})},copy_booking_settings:function(data){let settings=void 0===data.is_bulk_booking?data.settings.copy_booking_settings_data:data.bulk_booking_booking_settings_data;if(""===settings)return void tyche.bkap.notification(data.settings.labels.copy_booking_settings_error_message,"alert");const element=document.createElement("textarea");element.value=settings,document.querySelector("body").appendChild(element),element.select(),document.execCommand("copy")?tyche.bkap.notification(data.settings.labels.copy_booking_settings_success_message,"success"):tyche.bkap.notification(data.settings.labels.copy_booking_settings_error_message,"alert"),element.remove()}}},import_booking:{table:{init:function(){jQuery(document).on("click",".import-booking-table .bkap-wp-list-table .tablenav-pages a, .import-booking-table .bkap-wp-list-table .manage-column.sorted a",function(e){e.preventDefault();let query=this.search.substring(1);tyche.bkap.import_booking.table.display({page:tyche.bkap.import_booking.table.__query(query,"paged")||"1",order:tyche.bkap.import_booking.table.__query(query,"order")||"desc",orderby:tyche.bkap.import_booking.table.__query(query,"orderby")||"date",search:jQuery("#search-google-event-search-input").val(),status:jQuery(".import-booking-table input[name=import_booking_status]").val()||"all"})}),jQuery(document).on("click",".import-booking-table #google-event-search, .import-booking-table .bkap-wp-list-table .manage-column.sortable a",function(e){e.preventDefault();let element=jQuery(this).parent();element.hasClass("sortable")&&(element.hasClass("asc")||element.hasClass("desc"))&&(jQuery(".import-booking-table input[name=orderby]").val(element.attr("id")),jQuery(".import-booking-table input[name=order]").val(element.hasClass("asc")?"asc":"desc"),element.hasClass("asc")&&element.removeClass("asc").addClass("desc"),element.hasClass("desc")&&element.removeClass("desc").addClass("asc")),tyche.bkap.import_booking.table.display({page:parseInt(jQuery(".import-booking-table input[name=paged]").val())||"1",order:jQuery(".import-booking-table input[name=order]").val()||"desc",orderby:jQuery(".import-booking-table input[name=orderby]").val()||"ID",search:jQuery(".import-booking-table #search-google-event-search-input").val(),status:jQuery(".import-booking-table input[name=import_booking_status]").val()||"all"})}),tyche.bkap.import_booking.table.__init_after_ajax_request(),jQuery(document).on("keypress",".import-booking-table #search-google-event-search-input",function(e){if(13===e.which)return jQuery("#google-event-search").trigger("click"),!1}),jQuery(document).on("click",".import-booking-action",function(){if("set-status"===jQuery(this).attr("data-action")){let status=jQuery(this).attr("data-status");jQuery(".import-booking-table input[name=import_booking_status]").val(status),jQuery(".import-booking-table #search-google-event-search-input").val(""),jQuery("#google-event-search").trigger("click")}}),jQuery(document).on("click",".import-booking-table .map_event",function(e){e.preventDefault(),jQuery(".import-booking-table #show_mapping_event_loader").show();let exploded_id=this.name.split("_"),id=exploded_id[exploded_id.length-1],selectID="import_event_"+id,product_id=document.getElementById(selectID).value;axios.post(`${tyche.bkap.rest_url()}import-booking/table/map-event`,{data:{id:id,product_id:product_id}},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(jQuery("#post-"+id).remove(),jQuery(".import-booking-table #show_mapping_event_loader").hide(),jQuery("#google-event-search").trigger("click"),tyche.bkap.notification(response.data.message,"success")):"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),jQuery(".import-booking-table #show_mapping_event_loader").hide()):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),jQuery(".import-booking-table #show_mapping_event_loader").hide())}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),jQuery(".import-booking-table #show_mapping_event_loader").hide()})}),jQuery(".import-booking-table").on("change","select[id^=import_event_]",function(){var map_button_name='[name="map_event_'+this.id.split("_")[2]+'"]';""===this.value?jQuery(map_button_name).prop("disabled",!0):jQuery(map_button_name).removeAttr("disabled")})},display:function(data){jQuery(".import-booking-table #show_loading_loader").show(),axios.post(`${tyche.bkap.rest_url()}import-booking/table/display`,{data:data},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(response.data.rows.length&&jQuery(".import-booking-table .bkap-wp-list-table #the-list").html(response.data.rows),response.data.column_headers.length&&jQuery(".import-booking-table .bkap-wp-list-table thead tr, tfoot tr").html(response.data.column_headers),response.data.navigation.top.length&&jQuery(".import-booking-table .bkap-wp-list-table .tablenav.top").html(response.data.navigation.top),response.data.navigation.bottom.length&&jQuery(".import-booking-table .bkap-wp-list-table .tablenav.bottom").html(response.data.navigation.bottom),response.data.views.length&&(jQuery(".import-booking-table .bkap-wp-list-table .the-table .subsubsub").remove(),jQuery(".import-booking-table .bkap-wp-list-table .the-table").prepend(response.data.views)),setTimeout(function(){tyche.bkap.import_booking.table.__init_after_ajax_request(),jQuery(".import-booking-table #show_loading_loader").hide()},500)):"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),jQuery(".import-booking-table #show_loading_loader").hide()):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),jQuery(".import-booking-table #show_loading_loader").hide())}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),jQuery(".import-booking-table #show_loading_loader").hide()})},__query:function(query,variable){for(var vars=query.split("&"),i=0;i<vars.length;i++){var pair=vars[i].split("=");if(pair[0]==variable)return pair[1]}return!1},__init_after_ajax_request:function(){jQuery(".import-booking-table input[name=paged]").on("keypress",function(e){13===e.which&&(e.preventDefault(),tyche.bkap.resources.table.display({page:parseInt(jQuery(".import-booking-table input[name=paged]").val())||"1",order:jQuery(".import-booking-table input[name=order]").val()||"desc",orderby:jQuery(".import-booking-table input[name=orderby]").val()||"date",search:jQuery(".import-booking-table #search-google-event-search-input").val(),status:jQuery(".import-booking-table input[name=import_booking_status]").val()||"all"}))})}}},reminders:{table:{init:function($this){jQuery(document).on("click",".reminders-table .bkap-wp-list-table .tablenav-pages a, .bkap-wp-list-table .manage-column.sorted a",function(e){e.preventDefault();let query=this.search.substring(1);tyche.bkap.reminders.table.display({page:tyche.bkap.reminders.table.__query(query,"paged")||"1",order:tyche.bkap.reminders.table.__query(query,"order")||"desc",orderby:tyche.bkap.reminders.table.__query(query,"orderby")||"date",search:jQuery("#reminder-search-input").val(),status:jQuery(".reminders-table input[name=reminder_status]").val()||"all"})}),jQuery(document).on("click",".reminders-table #reminders-search, .reminders-table .bkap-wp-list-table .manage-column.sortable a",function(e){e.preventDefault();let element=jQuery(this).parent();element.hasClass("sortable")&&(element.hasClass("asc")||element.hasClass("desc"))&&(jQuery(".reminders-table input[name=orderby]").val(element.attr("id")),jQuery(".reminders-table input[name=order]").val(element.hasClass("asc")?"asc":"desc"),element.hasClass("asc")&&element.removeClass("asc").addClass("desc"),element.hasClass("desc")&&element.removeClass("desc").addClass("asc")),tyche.bkap.reminders.table.display({page:parseInt(jQuery(".reminders-table input[name=paged]").val())||"1",order:jQuery(".reminders-table input[name=order]").val()||"desc",orderby:jQuery(".reminders-table input[name=orderby]").val()||"date",search:jQuery(".reminders-table #reminder-search-input").val(),status:jQuery(".reminders-table input[name=reminder_status]").val()||"all"})}),tyche.bkap.reminders.table.__init_after_ajax_request(),jQuery(document).on("click","#button_empty_trash",function(){tyche.bkap.confirm_dialog(bkap_params.empty_trash_text,bkap_params.are_you_sure_you_want_to_empty_trash,function(){let loader=".reminders-table #show_custom_message_loader";jQuery(`${loader} div.bkap_admin_loader_wrapper span`).html(bkap_params.empty_trash),jQuery(loader).show(),axios.post(`${tyche.bkap.rest_url()}reminders/delete-trashed-reminders`,{},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(jQuery("#reminders-search").trigger("click"),tyche.bkap.notification(response.data.message,"success")):"error"===response.data.type&&tyche.bkap.notification(response.data.error_description,"warning"):tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"warning"),jQuery(loader).hide()}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"warning"),jQuery(loader).hide()})},function(){},"Yes","No")}),jQuery(document).on("click",".reminders-table #doaction, .reminders-table #doaction2",function(){let selected_button=jQuery(this).prop("id"),select_element="doaction"===selected_button?"bulk-action-selector-top":"";if(select_element="doaction2"===selected_button?"bulk-action-selector-bottom":select_element,""===select_element)return;let selected_option=jQuery(`.reminders-table select#${select_element}`).val();if(""===selected_option||"-1"===selected_option)return;let ids=[];if(jQuery('.table-view-list.reminders tbody#the-list tr input[type="checkbox"]').each(function(){jQuery(this).prop("checked")&&ids.push(jQuery(this).attr("data-reminder-id"))}),0!==ids.length){if(["bulk_action_trash_reminder","bulk_action_restore_reminder","bulk_action_delete_permanently_reminder"].includes(selected_option)){let action="trash";return action="bulk_action_restore_reminder"===selected_option?"restore":action,action="bulk_action_delete_permanently_reminder"===selected_option?"delete":action,void tyche.bkap.reminders.table.reminder_action(`${bkap_view_view_reminders_param.label[action+"_reminders_text"]}`,`${bkap_view_view_reminders_param.label["are_you_sure_you_want_to_"+action+"_reminders"]}`,ids,action)}}else tyche.bkap.notification(bkap_view_view_reminders_param.label.no_reminders_selected,"warning")}),jQuery(document).on("click",".reminders-action",function(){let reminder_id=jQuery(this).attr("data-reminder-id"),reminder_title=jQuery(this).attr("data-reminder-title"),action=jQuery(this).attr("data-action");if("set-status"===action){let status=jQuery(this).attr("data-status");return jQuery(".reminders-table input[name=reminder_status]").val(status),jQuery("#reminder-search-input").val(""),jQuery("#reminders-search").trigger("click"),"trash"===status?void jQuery("#button_empty_trash").removeClass("hide"):void jQuery("#button_empty_trash").addClass("hide")}if("edit"===action)return $this.show_loading_loader=!0,void axios.post(`${tyche.bkap.rest_url()}reminders/fetch-reminder`,{reminder_id:reminder_id},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?($this.is_edit_mode=!0,$this.data.reminder_data=response.data.data,$this.show_add_edit_reminder_page=!0,jQuery("#email_content_ifr").contents().find("body").html(response.data.data.email_content),setTimeout(function(){tyche.bkap.choices_js.render_choices_js_elements("reminder_selected_products",response.data.data.products,".reminder_selected_products",!1,!1)},500),setTimeout(function(){$this.show_loading_loader=!1},5e3)):"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),$this.show_loading_loader=!1):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),$this.show_loading_loader=!1)}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),$this.show_loading_loader=!1});tyche.bkap.reminders.table.reminder_action(`${action.toLowerCase().charAt(0).toUpperCase()+action.slice(1)} ${bkap_view_view_reminders_param.label.reminder_caps}`,`${bkap_view_view_reminders_param.label.are_you_sure_you_want_to} ${action} ${bkap_view_view_reminders_param.label.reminder_caps} - ${reminder_title}?`,reminder_id,action)}),jQuery("input.button.action").each(function(){jQuery(this).addClass("trietary-btn reverse")}),jQuery(document).on("click",".reminders-table th.manage-column.column-checkbox label, .reminders-table th.manage-column.column-checkbox input",function(){let input_element=jQuery('.reminders-table th.column-checkbox input[type="checkbox"].checkbox_select_all');if(!input_element||0===input_element.length)return;let checkbox=jQuery(input_element.first()).prop("checked");jQuery(input_element).prop("checked",!checkbox),jQuery('.table-view-list.reminders tbody#the-list tr input[type="checkbox"]').each(function(){jQuery(this).prop("checked",!checkbox)})}),jQuery(document).on("click","div.secondary-nav-wrap ul li.add_reminder",function(e){e.preventDefault(),$this.is_edit_mode=!1,$this.data.reminder_data={id:0,title:"",email_subject:$this.data.settings.email_subject,email_heading:$this.data.settings.email_heading,products:[],trigger:"before_booking_date",sending_delay_value:0,sending_delay_unit:"hours",is_sms_enabled:"",sms_content:$this.data.settings.sms_content,status:"bkap-active"},jQuery("#bkap_wp_editor_email_content").html($this.data.wp_editor_data),tinymce.execCommand("mceRemoveEditor",!1,"email_content"),tinymce.execCommand("mceAddEditor",!1,"email_content"),jQuery("#email_content_ifr").contents().find("body").html($this.data.settings.email_content),setTimeout(function(){void 0!==tyche.bkap.choices_js.instances.reminder_selected_products&&(tyche.bkap.choices_js.instances.reminder_selected_products.destroy(),delete tyche.bkap.choices_js.instances.reminder_selected_products),tyche.bkap.choices_js.render_choices_js_elements("reminder_selected_products",[],".reminder_selected_products",!1,!1)},500),$this.show_add_edit_reminder_page=!0}),jQuery(document).on("click","div.secondary-nav-wrap ul li.view_reminders",function(e){if(e.preventDefault(),$this.show_add_edit_reminder_page){if(jQuery(this).hasClass("processing"))return;jQuery(this).addClass("processing"),jQuery("#reminders-search").trigger("click"),$this.show_add_edit_reminder_page=!1,jQuery(this).removeClass("processing")}}),jQuery(document).on("click","div.secondary-nav-wrap ul li.manual_reminder",function(e){e.preventDefault(),tyche.bkap.reminders.table.render_manual_reminder_page_data($this)}),jQuery(document).on("keypress","#reminder-search-input",function(e){if(13===e.which)return jQuery("#reminders-search").trigger("click"),!1}),setTimeout(function(){tyche.bkap.reminders.table.bulk_action_settings()},500)},display:function(data){jQuery(".reminders-table #show_loading_loader").show(),axios.post(`${tyche.bkap.rest_url()}reminders/table/display`,{data:data},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(response.data.rows.length&&jQuery(".reminders-table .bkap-wp-list-table #the-list").html(response.data.rows),response.data.column_headers.length&&jQuery(".reminders-table .bkap-wp-list-table thead tr, tfoot tr").html(response.data.column_headers),response.data.navigation.top.length&&jQuery(".reminders-table .bkap-wp-list-table .tablenav.top").html(response.data.navigation.top),response.data.navigation.bottom.length&&jQuery(".reminders-table .bkap-wp-list-table .tablenav.bottom").html(response.data.navigation.bottom),response.data.views.length&&(jQuery(".reminders-table .bkap-wp-list-table .the-table .subsubsub").remove(),jQuery(".reminders-table .bkap-wp-list-table .the-table").prepend(response.data.views)),setTimeout(function(){tyche.bkap.reminders.table.bulk_action_settings(),tyche.bkap.reminders.table.__init_after_ajax_request(),jQuery(".reminders-table #show_loading_loader").hide()},500)):"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),jQuery(".reminders-table #show_loading_loader").hide()):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),jQuery(".reminders-table #show_loading_loader").hide())}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),jQuery(".reminders-table #show_loading_loader").hide()})},reminder_action:function(title,confirmation_text,reminder_id,action){tyche.bkap.confirm_dialog(title,confirmation_text,function(){let loader=".reminders-table #show_custom_message_loader";jQuery(`${loader} div.bkap_admin_loader_wrapper span`).html(bkap_view_view_reminders_param.label[action+"_reminder"+(Array.isArray(reminder_id)?"s":"")]),jQuery(loader).show(),axios.post(`${tyche.bkap.rest_url()}reminders/${action}-reminder`,{reminder_id:reminder_id},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(jQuery("#reminders-search").trigger("click"),tyche.bkap.notification(response.data.message,"success")):"error"===response.data.type&&tyche.bkap.notification(response.data.error_description,"warning"):tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"warning"),jQuery(loader).hide()}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"warning"),jQuery(loader).hide()})},function(){},"Yes","No")},__query:function(query,variable){for(var vars=query.split("&"),i=0;i<vars.length;i++){var pair=vars[i].split("=");if(pair[0]==variable)return pair[1]}return!1},__init_after_ajax_request:function(){jQuery(".reminders-table input[name=paged]").on("keypress",function(e){13===e.which&&(e.preventDefault(),tyche.bkap.resources.table.display({page:parseInt(jQuery(".reminders-table input[name=paged]").val())||"1",order:jQuery(".reminders-table input[name=order]").val()||"desc",orderby:jQuery(".reminders-table input[name=orderby]").val()||"date",search:jQuery(".reminders-table #reminder-search-input").val(),status:jQuery(".reminders-table input[name=reminder_status]").val()||"all"}))})},render_manual_reminder_page_data:function($this){jQuery("#bkap_wp_editor_email_content").html($this.data.wp_editor_data),tinymce.execCommand("mceRemoveEditor",!1,"email_content"),tinymce.execCommand("mceAddEditor",!1,"email_content"),jQuery("#email_content_ifr").contents().find("body").html($this.data.settings.manual_reminder_email_content),void 0!==tyche.bkap.choices_js.instances.manual_reminder_send_reminder_for_order&&(tyche.bkap.choices_js.instances.manual_reminder_send_reminder_for_order.destroy(),delete tyche.bkap.choices_js.instances.manual_reminder_send_reminder_for_order),tyche.bkap.choices_js.render_choices_js_elements("manual_reminder_send_reminder_for_order",[],".manual_reminder_send_reminder_for_order",!1,!1),void 0!==tyche.bkap.choices_js.instances.manual_reminder_send_reminder_for_booking&&(tyche.bkap.choices_js.instances.manual_reminder_send_reminder_for_booking.destroy(),delete tyche.bkap.choices_js.instances.manual_reminder_send_reminder_for_booking),tyche.bkap.choices_js.render_choices_js_elements("manual_reminder_send_reminder_for_booking",[],".manual_reminder_send_reminder_for_booking",!1,!1),void 0!==tyche.bkap.choices_js.instances.manual_reminder_send_reminder_for_product&&(tyche.bkap.choices_js.instances.manual_reminder_send_reminder_for_product.destroy(),delete tyche.bkap.choices_js.instances.manual_reminder_send_reminder_for_product),tyche.bkap.choices_js.render_choices_js_elements("manual_reminder_send_reminder_for_product",[],".manual_reminder_send_reminder_for_product",!1,!1)},bulk_action_settings:function(){let status=jQuery(".reminders-table input[name=reminder_status]").val();if(jQuery("select#bulk-action-selector-top").val("-1"),jQuery("select#bulk-action-selector-bottom").val("-1"),"trash"===status)return jQuery('select#bulk-action-selector-top option[value="bulk_action_trash_reminder"]').hide(),jQuery('select#bulk-action-selector-top option[value="bulk_action_restore_reminder"]').show(),jQuery('select#bulk-action-selector-top option[value="bulk_action_delete_permanently_reminder"]').show(),jQuery('select#bulk-action-selector-bottom option[value="bulk_action_trash_reminder"]').hide(),jQuery('select#bulk-action-selector-bottom option[value="bulk_action_restore_reminder"]').show(),jQuery('select#bulk-action-selector-bottom option[value="bulk_action_delete_permanently_reminder"]').show(),void jQuery(".reminders-action.dashicons.dashicons-trash.color-red").each(function(){jQuery(this).attr("data-action","delete")});jQuery('select#bulk-action-selector-top option[value="bulk_action_trash_reminder"]').show(),jQuery('select#bulk-action-selector-top option[value="bulk_action_restore_reminder"]').hide(),jQuery('select#bulk-action-selector-top option[value="bulk_action_delete_permanently_reminder"]').hide(),jQuery('select#bulk-action-selector-bottom option[value="bulk_action_trash_reminder"]').show(),jQuery('select#bulk-action-selector-bottom option[value="bulk_action_restore_reminder"]').hide(),jQuery('select#bulk-action-selector-bottom option[value="bulk_action_delete_permanently_reminder"]').hide()}}},resources:{table:{init:function($this){jQuery(document).on("click",".resources-table .bkap-wp-list-table .tablenav-pages a, .resources-table .bkap-wp-list-table .manage-column.sorted a",function(e){e.preventDefault();let query=this.search.substring(1);tyche.bkap.resources.table.display({page:tyche.bkap.resources.table.__query(query,"paged")||"1",order:tyche.bkap.resources.table.__query(query,"order")||"desc",orderby:tyche.bkap.resources.table.__query(query,"orderby")||"date",search:jQuery("#resources-search-input").val(),filter:jQuery("#filter_dropdown_dates").val(),status:jQuery(".resources-table input[name=resource_status]").val()||"all"})}),jQuery(document).on("click",".resources-table #resources-search, .resources-table #button_resource_filter, .resources-table .bkap-wp-list-table .manage-column.sortable a",function(e){e.preventDefault();let element=jQuery(this).parent();element.hasClass("sortable")&&(element.hasClass("asc")||element.hasClass("desc"))&&(jQuery(".resources-table input[name=orderby]").val(element.attr("id")),jQuery(".resources-table input[name=order]").val(element.hasClass("asc")?"asc":"desc"),element.hasClass("asc")&&element.removeClass("asc").addClass("desc"),element.hasClass("desc")&&element.removeClass("desc").addClass("asc")),tyche.bkap.resources.table.display({page:parseInt(jQuery(".resources-table input[name=paged]").val())||"1",order:jQuery(".resources-table input[name=order]").val()||"desc",orderby:jQuery(".resources-table input[name=orderby]").val()||"date",search:jQuery(".resources-table #resources-search-input").val(),filter:jQuery("#filter_dropdown_dates").val(),status:jQuery(".resources-table input[name=resource_status]").val()||"all"})}),tyche.bkap.resources.table.__init_after_ajax_request(),jQuery(document).on("click",".resources-table #doaction, .resources-table #doaction2",function(){let selected_button=jQuery(this).prop("id"),select_element="doaction"===selected_button?"bulk-action-selector-top":"";if(select_element="doaction2"===selected_button?"bulk-action-selector-bottom":select_element,""===select_element)return;let selected_option=jQuery(`.resources-table select#${select_element}`).val();if(""===selected_option||"-1"===selected_option)return;let ids=[];if(jQuery('.table-view-list.resources tbody#the-list tr input[type="checkbox"]').each(function(){jQuery(this).prop("checked")&&ids.push(jQuery(this).attr("data-resource-id"))}),0!==ids.length){if(["bulk_action_trash_resource","bulk_action_restore_resource","bulk_action_delete_permanently_resource"].includes(selected_option)){let action="trash";return action="bulk_action_restore_resource"===selected_option?"restore":action,action="bulk_action_delete_permanently_resource"===selected_option?"delete":action,void tyche.bkap.resources.table.resource_action(`${bkap_view_resources_param.label[action+"_resources_text"]}`,`${bkap_view_resources_param.label["are_you_sure_you_want_to_"+action+"_resources"]}`,ids,action)}}else tyche.bkap.notification(bkap_view_resources_param.label.no_resources_selected,"warning")}),void 0===bkap_view_resources_param.resource_id||""===bkap_view_resources_param.resource_id?(jQuery(document).on("click",".resources-action",function(){let resource_id=jQuery(this).attr("data-resource-id"),resource_title=jQuery(this).attr("data-resource-title"),action=jQuery(this).attr("data-action");if("set-status"===action){let status=jQuery(this).attr("data-status");return jQuery(".resources-table input[name=resource_status]").val(status),jQuery("#resources-search-input").val(""),jQuery("#filter_dropdown_dates").val("all_dates"),jQuery("#resources-search").trigger("click"),"trash"===status?void jQuery("#button_empty_trash").removeClass("hide"):void jQuery("#button_empty_trash").addClass("hide")}"edit"!==action?tyche.bkap.resources.table.resource_action(`${action.toLowerCase().charAt(0).toUpperCase()+action.slice(1)} ${bkap_view_resources_param.label.resource_caps}`,`${bkap_view_resources_param.label.are_you_sure_you_want_to} ${action} ${bkap_view_resources_param.label.resource_caps} - ${resource_title}?`,resource_id,action):tyche.bkap.resources.table.edit_action($this,resource_id)}),jQuery("input.button.action").each(function(){jQuery(this).addClass("trietary-btn reverse")}),jQuery(document).on("click",".resources-table th.manage-column.column-checkbox label, .resources-table th.manage-column.column-checkbox input",function(){let input_element=jQuery('.resources-table th.column-checkbox input[type="checkbox"].checkbox_select_all');if(!input_element||0===input_element.length)return;let checkbox=jQuery(input_element.first()).prop("checked");jQuery(input_element).prop("checked",!checkbox),jQuery('.table-view-list.resources tbody#the-list tr input[type="checkbox"]').each(function(){jQuery(this).prop("checked",!checkbox)})}),jQuery(document).on("click","div.secondary-nav-wrap ul li.add_resource",function(e){e.preventDefault(),$this.is_edit_mode=!1,$this.data.add_edit_resource.data={id:0,title:"",qty:1,menu_order:0,meeting_host:"",availability:[]},$this.show_add_edit_resource_page=!0}),jQuery(document).on("click","div.secondary-nav-wrap ul li.resources",function(e){e.preventDefault(),jQuery("#resources-search").trigger("click"),$this.show_add_edit_resource_page=!1}),jQuery(document).on("keypress","#resources-search-input",function(e){if(13===e.which)return jQuery("#resources-search").trigger("click"),!1}),jQuery(document).on("click","#button_empty_trash",function(){tyche.bkap.confirm_dialog(bkap_params.empty_trash_text,bkap_params.are_you_sure_you_want_to_empty_trash,function(){let loader=".resources-table #show_custom_message_loader";jQuery(`${loader} div.bkap_admin_loader_wrapper span`).html(bkap_params.empty_trash),jQuery(loader).show(),axios.post(`${tyche.bkap.rest_url()}resources/delete-trashed-resources`,{},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(jQuery("#resources-search").trigger("click"),tyche.bkap.notification(response.data.message,"success")):"error"===response.data.type&&tyche.bkap.notification(response.data.error_description,"warning"):tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"warning"),jQuery(loader).hide()}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"warning"),jQuery(loader).hide()})},function(){},"Yes","No")}),setTimeout(function(){tyche.bkap.resources.table.bulk_action_settings()},500)):tyche.bkap.resources.table.edit_action($this,bkap_view_resources_param.resource_id)},edit_action:function($this,resource_id){$this.show_loading_loader=!0,axios.post(`${tyche.bkap.rest_url()}resources/fetch-resource`,{resource_id:resource_id},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?($this.is_edit_mode=!0,$this.data.add_edit_resource.data=response.data.data,$this.show_add_edit_resource_page=!0,setTimeout(function(){$this.show_loading_loader=!1},5e3)):"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),$this.show_loading_loader=!1):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),$this.show_loading_loader=!1)}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),$this.show_loading_loader=!1})},display:function(data){jQuery(".resources-table #show_loading_loader").show(),axios.post(`${tyche.bkap.rest_url()}resources/table/display`,{data:data},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(response.data.rows.length&&jQuery(".resources-table .bkap-wp-list-table #the-list").html(response.data.rows),response.data.column_headers.length&&jQuery(".resources-table .bkap-wp-list-table thead tr, tfoot tr").html(response.data.column_headers),response.data.navigation.top.length&&jQuery(".resources-table .bkap-wp-list-table .tablenav.top").html(response.data.navigation.top),response.data.navigation.bottom.length&&jQuery(".resources-table .bkap-wp-list-table .tablenav.bottom").html(response.data.navigation.bottom),response.data.views.length&&(jQuery(".resources-table .bkap-wp-list-table .the-table .subsubsub").remove(),jQuery(".resources-table .bkap-wp-list-table .the-table").prepend(response.data.views)),setTimeout(function(){tyche.bkap.resources.table.__init_after_ajax_request(),tyche.bkap.resources.table.bulk_action_settings(),jQuery(".resources-table #show_loading_loader").hide()},500)):"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),jQuery(".resources-table #show_loading_loader").hide()):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),jQuery(".resources-table #show_loading_loader").hide())}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),jQuery(".resources-table #show_loading_loader").hide()})},resource_action:function(title,confirmation_text,resource_id,action){tyche.bkap.confirm_dialog(title,confirmation_text,function(){let loader=".resources-table #show_custom_message_loader";jQuery(`${loader} div.bkap_admin_loader_wrapper span`).html(bkap_view_resources_param.label[action+"_resource"+(Array.isArray(resource_id)?"s":"")]),jQuery(loader).show(),axios.post(`${tyche.bkap.rest_url()}resources/${action}-resource`,{resource_id:resource_id},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(jQuery("#resources-search").trigger("click"),tyche.bkap.notification(response.data.message,"success")):"error"===response.data.type&&tyche.bkap.notification(response.data.error_description,"warning"):tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"warning"),jQuery(loader).hide()}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"warning"),jQuery(loader).hide()})},function(){},"Yes","No")},__query:function(query,variable){for(var vars=query.split("&"),i=0;i<vars.length;i++){var pair=vars[i].split("=");if(pair[0]==variable)return pair[1]}return!1},__init_after_ajax_request:function(){jQuery(".resources-table input[name=paged]").on("keypress",function(e){13===e.which&&(e.preventDefault(),tyche.bkap.resources.table.display({page:parseInt(jQuery(".resources-table input[name=paged]").val())||"1",order:jQuery(".resources-table input[name=order]").val()||"desc",orderby:jQuery(".resources-table input[name=orderby]").val()||"date",search:jQuery(".resources-table #resources-search-input").val(),filter:jQuery("#filter_dropdown_dates").val(),status:jQuery(".resources-table input[name=resource_status]").val()||"all"}))})},bulk_action_settings:function(){let status=jQuery(".resources-table input[name=resource_status]").val();if(jQuery("select#bulk-action-selector-top").val("-1"),jQuery("select#bulk-action-selector-bottom").val("-1"),"trash"===status)return jQuery('select#bulk-action-selector-top option[value="bulk_action_trash_resource"]').hide(),jQuery('select#bulk-action-selector-top option[value="bulk_action_restore_resource"]').show(),jQuery('select#bulk-action-selector-top option[value="bulk_action_delete_permanently_resource"]').show(),jQuery('select#bulk-action-selector-bottom option[value="bulk_action_trash_resource"]').hide(),jQuery('select#bulk-action-selector-bottom option[value="bulk_action_restore_resource"]').show(),jQuery('select#bulk-action-selector-bottom option[value="bulk_action_delete_permanently_resource"]').show(),void jQuery(".resources-action.dashicons.dashicons-trash.color-red").each(function(){jQuery(this).attr("data-action","delete")});jQuery('select#bulk-action-selector-top option[value="bulk_action_trash_resource"]').show(),jQuery('select#bulk-action-selector-top option[value="bulk_action_restore_resource"]').hide(),jQuery('select#bulk-action-selector-top option[value="bulk_action_delete_permanently_resource"]').hide(),jQuery('select#bulk-action-selector-bottom option[value="bulk_action_trash_resource"]').show(),jQuery('select#bulk-action-selector-bottom option[value="bulk_action_restore_resource"]').hide(),jQuery('select#bulk-action-selector-bottom option[value="bulk_action_delete_permanently_resource"]').hide()}}},view_bookings:{table:{init:function($this){jQuery(document).on("click",".view-bookings-table .bkap-wp-list-table .tablenav-pages a",function(e){e.preventDefault();let query=this.search.substring(1);tyche.bkap.view_bookings.table.display({page:tyche.bkap.view_bookings.table.__query(query,"paged")||"1",order:jQuery(".view-bookings-table input[name=order]").val()||"desc",orderby:jQuery(".view-bookings-table input[name=orderby]").val()||"ID",search:jQuery(".view-bookings-table #search-view-bookings-search-input").val(),filter:tyche.bkap.view_bookings.table.__filter(),status:jQuery(".view-bookings-table input[name=booking_status]").val()||"all"})}),jQuery(document).on("click",".view-bookings-table #view-bookings-search, .view-bookings-table #button_view_bookings_apply_filters, .view-bookings-table .bkap-wp-list-table .manage-column.sortable a, .view-bookings-table .bkap-wp-list-table .manage-column.sorted a",function(e){e.preventDefault();let element=jQuery(this).parent(),current_id=jQuery(this).attr("id");"view-bookings-search"!=current_id&&"button_view_bookings_apply_filters"!=current_id||jQuery(".view-bookings-table input[name=paged]").val(1),(element.hasClass("sortable")||element.hasClass("sorted"))&&(element.hasClass("asc")||element.hasClass("desc"))&&(jQuery(".view-bookings-table input[name=orderby]").val(element.attr("id")),jQuery(".view-bookings-table input[name=order]").val(element.hasClass("asc")?"asc":"desc"),element.hasClass("asc")?(element.removeClass("asc").addClass("desc"),jQuery(".view-bookings-table input[name=order]").val("desc")):(element.removeClass("desc").addClass("asc"),jQuery(".view-bookings-table input[name=order]").val("asc"))),tyche.bkap.view_bookings.table.display({page:parseInt(jQuery(".view-bookings-table input[name=paged]").val())||"1",order:jQuery(".view-bookings-table input[name=order]").val()||"desc",orderby:jQuery(".view-bookings-table input[name=orderby]").val()||"ID",search:jQuery(".view-bookings-table #search-view-bookings-search-input").val(),filter:tyche.bkap.view_bookings.table.__filter(),status:jQuery(".view-bookings-table input[name=booking_status]").val()||"all"})}),jQuery("#bkap-show-settings-link").on("click",function(){"false"==jQuery("#bkap-show-settings-link").attr("aria-expanded")?(jQuery("#bkap-screen-meta").show(),jQuery("#bkap-show-settings-link").attr("aria-expanded","true"),jQuery(".bkap-show-settings").addClass("bkap-screen-meta-active")):(jQuery("#bkap-show-settings-link").attr("aria-expanded","false"),jQuery("#bkap-screen-meta").hide(),jQuery(".bkap-show-settings").removeClass("bkap-screen-meta-active"))}),tyche.bkap.view_bookings.table.__init_after_ajax_request(),jQuery(document).on("click",".view-bookings-table #doaction, .view-bookings-table #doaction2",function(){let selected_button=jQuery(this).prop("id"),select_element="doaction"===selected_button?"bulk-action-selector-top":"";if(select_element="doaction2"===selected_button?"bulk-action-selector-bottom":select_element,""===select_element)return;let selected_option=jQuery(`.view-bookings-table select#${select_element}`).val();if(""===selected_option||"-1"===selected_option)return;let booking_ids=[];if(jQuery('.table-view-list.bookings tbody#the-list tr input[type="checkbox"]').each(function(){jQuery(this).prop("checked")&&booking_ids.push(jQuery(this).attr("data-booking-id"))}),0!==booking_ids.length){if("bulk_action_delete_booking"===selected_option||"bulk_action_confirm_booking"===selected_option||"bulk_action_cancel_booking"===selected_option){let action="bulk_action_delete_booking"===selected_option?"delete":"";return action="bulk_action_confirm_booking"===selected_option?"confirm":action,action="bulk_action_cancel_booking"===selected_option?"cancel":action,void tyche.bkap.view_bookings.table.booking_action(`${bkap_view_view_bookings_param.label[action+"_bookings_text"]}`,`${bkap_view_view_bookings_param.label["are_you_sure_you_want_to_"+action+"_bookings"]}`,booking_ids,action)}}else tyche.bkap.notification(bkap_view_view_bookings_param.label.no_bookings_selected,"warning")}),jQuery(document).on("click",".view-bookings-table th.manage-column.column-checkbox label, .view-bookings-table th.manage-column.column-checkbox input",function(){let input_element=jQuery('.view-bookings-table th.column-checkbox input[type="checkbox"].checkbox_select_all');if(!input_element||0===input_element.length)return;let checkbox=jQuery(input_element.first()).prop("checked");jQuery(input_element).prop("checked",!checkbox),jQuery('.table-view-list.bookings tbody#the-list tr input[type="checkbox"]').each(function(){jQuery(this).prop("checked",!checkbox)})}),jQuery(document).on("click",".view-bookings-action",function(){let booking_id=jQuery(this).attr("data-booking-id"),action=jQuery(this).attr("data-action");if("set-status"===action){let status=jQuery(this).attr("data-status");return jQuery(".view-bookings-table input[name=booking_status]").val(status),jQuery(".view-bookings-table #search-view-bookings-search-input").val(""),jQuery("#filter_dropdown_dates").val("all_dates"),jQuery("#filter_bookable_products").val("all_bookable_products"),jQuery(".view_bookings_customer_search").val(""),jQuery("#bulk-action-selector-bottom").val(-1),jQuery("#bulk-action-selector-top").val(-1),jQuery("#filter_list_booking_by").val("default").change(),void jQuery("#view-bookings-search").trigger("click")}"edit"!==action?tyche.bkap.view_bookings.table.booking_action(`${action.toLowerCase().charAt(0).toUpperCase()+action.slice(1)} ${bkap_view_view_bookings_param.label.booking_caps}`,`${bkap_view_view_bookings_param.label.are_you_sure_you_want_to} ${action} ${bkap_view_view_bookings_param.label.booking_caps} #${booking_id}?`,booking_id,action):tyche.bkap.view_bookings.table.edit_action($this,booking_id)}),jQuery("input.button.action").each(function(){jQuery(this).addClass("trietary-btn reverse")}),jQuery(".bkap-content-area").before('<div class="bkap-view-bookings-data" style="display:none;"></div>'),jQuery(document).on("click","#button_view_bookings_csv",function(e){e.preventDefault(),tyche.bkap.view_bookings.table.process_csv_print(0,1,"csv")}),jQuery(document).on("click","#button_view_bookings_print",function(e){e.preventDefault(),tyche.bkap.view_bookings.table.process_csv_print(0,1,"print")}),jQuery("#bkap_qty").on("change",function(){if(jQuery("#wapbk_hidden_date").length>0)if("multiple_days"==edit_post_param.booking_type)""!=jQuery("#wapbk_hidden_date").val()&&""!=jQuery("#wapbk_hidden_date_checkout").val()&&bkap_calculate_price();else{var max_limit=parseInt(jQuery("#bkap_qty").attr("max")),qty_val=parseInt(jQuery("#bkap_qty").val());"NaN"!=max_limit&&max_limit>0&&qty_val>max_limit&&jQuery("#bkap_qty").val(max_limit),""!=jQuery("#wapbk_hidden_date").val()&&bkap_single_day_price()}}),jQuery("#filter_list_booking_by").on("change",function(){"custom_dates"===jQuery("#filter_list_booking_by").val()?jQuery(".filter_list_booking_by_input").addClass("show"):jQuery(".filter_list_booking_by_input").removeClass("show")}),jQuery(document).on("keypress",".view-bookings-table #search-view-bookings-search-input",function(e){if(13===e.which)return jQuery("#view-bookings-search").trigger("click"),!1}),void 0===bkap_view_view_bookings_param.booking_id||""===bkap_view_view_bookings_param.booking_id?$this.show_loading_loader=!1:tyche.bkap.view_bookings.table.edit_action($this,bkap_view_view_bookings_param.booking_id)},edit_action:function($this,booking_id){$this.show_loading_loader=!0,axios.post(`${tyche.bkap.rest_url()}view-bookings/date-html`,{booking_id:booking_id},{headers:{"X-WP-Nonce":bkap_params.nonce},params:{booking_post_id:booking_id}}).then(function(response){if(void 0!==response.data)if("success"===response.data.type){$this.data.edit_booking.data=response.data.data,jQuery("#bkap_edit_booking").html(response.data.html);const vue_data=response.data.vue_data,edit_post_param=response.data.edit;window.bkap_init_params=vue_data.bkap_init_params,window.bkap_process_params=vue_data.bkap_process_params,window.product_id=response.data.data.product_id,window.edit_post_param=edit_post_param,$this.show_edit_booking_page=!0,bkap_init_datepicker(),setTimeout(function(){if(jQuery("#wapbk_hidden_date").length>0){jQuery("#wapbk_hidden_date").val(edit_post_param.hidden_date);let split=jQuery("#wapbk_hidden_date").val().split("-"),bookingDate=new Date(split[2],split[1]-1,split[0]);if(jQuery("#booking_calender").datepicker("setDate",bookingDate),jQuery("#bkap_front_resource_selection").val(edit_post_param.resource),jQuery("#time_slot").val(edit_post_param.time_slot),jQuery("#bkap_field_persons").length>0?jQuery("#bkap_field_persons").val(edit_post_param.persons[0]):jQuery('input[id^="bkap_field_persons_"]').length>0&&jQuery('input[id^="bkap_field_persons_"]').each(function(i,row){let person_id=jQuery(this)[0].id.split("_")[3],person_val=jQuery(this).val();""==person_val&&(person_val=0),void 0!==edit_post_param.persons[person_id]&&jQuery(this).val(edit_post_param.persons[person_id])}),"multiple_days"===edit_post_param.booking_type){"YES"===edit_post_param.pastCheckout&&jQuery("#booking_calender_checkout").datepicker("option","minDate",bookingDate),jQuery("#wapbk_hidden_date_checkout").val(edit_post_param.hidden_checkout);let split=jQuery("#wapbk_hidden_date_checkout").val().split("-"),checkoutDate=new Date(split[2],split[1]-1,split[0]);if(jQuery("#booking_calender_checkout").datepicker("setDate",checkoutDate),jQuery("#block_option").length>0){jQuery("#block_option").val(edit_post_param.block_value);var block_value=edit_post_param.block_value.split("&");jQuery("#block_option_start_day").val(block_value[0]),jQuery("#block_option_number_of_days").val(block_value[1]),jQuery("#block_option_price").val(block_value[2])}jQuery(".ui-datepicker-current-day").trigger("click")}else bkap_process_date(edit_post_param.hidden_date)}$this.show_loading_loader=!1},5e3)}else"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),$this.show_loading_loader=!1);else tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),$this.show_loading_loader=!1}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),$this.show_loading_loader=!1})},display:function(data){jQuery("#show_loading_loader").show(),axios.post(`${tyche.bkap.rest_url()}view-bookings/table/display`,{data:data},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(response.data.rows.length&&jQuery(".view-bookings-table .bkap-wp-list-table #the-list").html(response.data.rows),response.data.column_headers.length&&jQuery(".view-bookings-table .bkap-wp-list-table thead tr, tfoot tr").html(response.data.column_headers),response.data.pagination.top.length&&jQuery(".view-bookings-table .bkap-wp-list-table .tablenav.top .tablenav-pages").html(jQuery(response.data.pagination.top).html()),response.data.pagination.bottom.length&&jQuery(".view-bookings-table .bkap-wp-list-table .tablenav.bottom .tablenav-pages").html(jQuery(response.data.pagination.bottom).html()),response.data.views.length&&(jQuery(".view-bookings-table .bkap-wp-list-table .the-table .subsubsub").remove(),jQuery(".view-bookings-table .bkap-wp-list-table .the-table").prepend(response.data.views)),setTimeout(function(){tyche.bkap.view_bookings.table.__init_after_ajax_request(),jQuery("#show_loading_loader").hide()},500)):"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),jQuery("#show_loading_loader").hide()):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),jQuery("#show_loading_loader").hide())}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),jQuery("#show_loading_loader").hide()})},process_csv_print:function(done_items,step,export_type){let loader="#show_"+("csv"===export_type?"csv_loader":"print_loader");jQuery(loader).is(":visible")||(jQuery(`${loader} div.bkap_admin_loader_wrapper span`).html("csv"===export_type?bkap_view_view_bookings_param.label.csv_loader:bkap_view_view_bookings_param.label.print_loader),jQuery(loader).show());let total_items=jQuery(".top .displaying-num").text();total_items=total_items.split(" "),total_items=total_items[0],total_items=parseInt(total_items.replace(/,/g,"")),axios.post(`${tyche.bkap.rest_url()}view-bookings/print-csv/export`,{data:{options:{order:jQuery(".view-bookings-table input[name=order]").val()||"desc",orderby:jQuery(".view-bookings-table input[name=orderby]").val()||"ID",search:jQuery(".view-bookings-table #search-view-bookings-search-input").val(),filter:tyche.bkap.view_bookings.table.__filter(),status:jQuery(".view-bookings-table input[name=booking_status]").val()||"all"},total_items:total_items,step:step,export_type:export_type,done_items:done_items,post_status:jQuery(".view-bookings-table input[name=booking_status]").val()}},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){if(void 0!==response.data)if("success"===response.data.type){if("done"===response.data.step){if("print"==export_type){let print_data=document.getElementById("bkap_print_data").outerHTML,win=window.open();if(null===win||void 0===win.document)return tyche.bkap.notification(bkap_view_view_bookings_param.label.error_enable_pop_up_window,"alert"),void jQuery(loader).hide();win.document.open(),win.document.write('<html><head><title>Print Bookings</title><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body>'+print_data+"</body></html>"),win.document.close(),win.print(),jQuery(".bkap-view-bookings-data").html("")}return"csv"==export_type&&(window.location=response.data.url),tyche.bkap.notification(response.data.message,"success"),void jQuery(loader).hide()}if("print"==export_type){let html=response.data.html;1===step?jQuery(".bkap-view-bookings-data").html(html):jQuery("#bkap_print_data").append(html)}jQuery(`${loader} div.bkap_admin_loader_wrapper span`).html(("csv"===export_type?bkap_view_view_bookings_param.label.csv_loader:bkap_view_view_bookings_param.label.print_loader)+" "+response.data.percentage+"% "+bkap_view_view_bookings_param.label.completed),jQuery(loader).show(),tyche.bkap.view_bookings.table.process_csv_print(response.data.done_items,parseInt(response.data.step),export_type)}else"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),jQuery(loader).hide());else tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),jQuery(loader).hide()}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),jQuery(loader).hide()})},booking_action:function(title,confirmation_text,booking_id,action){tyche.bkap.confirm_dialog(title,confirmation_text,function(){let loader="#show_custom_message_loader";jQuery(`${loader} div.bkap_admin_loader_wrapper span`).html(bkap_view_view_bookings_param.label[action+"_booking"+(Array.isArray(booking_id)?"s":"")]),jQuery(loader).show();const force_delete="trash"===jQuery("#booking_status").val();axios.post(`${tyche.bkap.rest_url()}view-bookings/${action}-booking`,{booking_id:booking_id,force_delete:force_delete},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(jQuery("#view-bookings-search").trigger("click"),tyche.bkap.notification(response.data.message,"success")):"error"===response.data.type&&tyche.bkap.notification(response.data.error_description,"warning"):tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"warning"),jQuery(loader).hide()}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"warning"),jQuery(loader).hide()})},function(){},"Yes","No")},__query:function(query,variable){for(var vars=query.split("&"),i=0;i<vars.length;i++){var pair=vars[i].split("=");if(pair[0]==variable)return pair[1]}return!1},__filter:function(){let filter={date:jQuery("#filter_dropdown_dates").val(),bookable_products:jQuery("#filter_bookable_products").val()},customer_id=jQuery(".view_bookings_customer_search").val();null!=customer_id&&""!==customer_id&&(filter.customer_id=parseInt(customer_id));let filter_list_booking_by=jQuery("#filter_list_booking_by").val();return"default"!==filter_list_booking_by&&(filter.list_booking_by=filter_list_booking_by,"custom_dates"===filter_list_booking_by&&(filter.custom_date_start=jQuery(".filter_list_booking_by_input.start_date").val(),filter.custom_date_end=jQuery(".filter_list_booking_by_input.end_date").val())),filter},__init_after_ajax_request:function(){jQuery(".view-bookings-table input[name=paged]").on("keypress",function(e){13===e.which&&(e.preventDefault(),tyche.bkap.view_bookings.table.display({page:parseInt(jQuery(".view-bookings-table input[name=paged]").val())||"1",order:jQuery(".view-bookings-table input[name=order]").val()||"desc",orderby:jQuery(".view-bookings-table input[name=orderby]").val()||"ID",search:jQuery(".view-bookings-table #search-view-bookings-search-input").val(),filter:tyche.bkap.view_bookings.table.__filter(),status:jQuery(".view-bookings-table input[name=booking_status]").val()||"all"}))})}}}}),jQuery(document).ready(function(){jQuery("#woocommerce-product-data").on("woocommerce_variations_loaded",function(){jQuery(document).on("focus",".variation_holidays",function(){var var_id="#"+jQuery(this)[0].id;jQuery("#"+jQuery(this)[0].id).datepick({minDate:new Date,dateFormat:"yyyy-mm-dd",multiSelect:999,monthsToShow:1,onClose:function(){jQuery(var_id).change()}})})}),setTimeout(function(){tyche.bkap.add_tool_tips_under_label_text(),tyche.bkap.event_listeners()})},500),jQuery(document).ready(function(){const html='<div class="custom-control custom-checkbox">\n\t\t\t<input type="checkbox" class="custom-control-input view_bookings_checkbox checkbox_select_all" id="checkbox_select_all">\n\t\t\t<label class="custom-control-label" for="checkbox_select_all"></label>\n\t\t</div>';function applyCustomCheckbox(){jQuery(".reminders-table .wp-list-table.table-view-list thead th.column-checkbox").html(html),jQuery(".resources-table .wp-list-table.table-view-list thead th.column-checkbox").html(html),jQuery(".view-bookings-table .wp-list-table.table-view-list thead th.column-checkbox").html(html)}applyCustomCheckbox(),jQuery(document).on("click",".view-bookings-action, li.view-bookings a, .resources-action, .reminders-action",function(){setTimeout(applyCustomCheckbox,2e3)})}));
