var view_reminders=Vue.component("tab-reminders",{template:"#reminders-tab",data:()=>({data:{label:{loading_loader:bkap_params.vue.label.loading_loader,saving_reminder_loader:bkap_view_view_reminders_param.label.saving_reminder_loader,updating_reminder_loader:bkap_view_view_reminders_param.label.updating_reminder_loader,add_reminder:bkap_view_view_reminders_param.label.add_reminder,edit_reminder:bkap_view_view_reminders_param.label.edit_reminder,save_reminder:bkap_view_view_reminders_param.label.save_reminder,update_reminder:bkap_view_view_reminders_param.label.update_reminder,show_sending_test_reminder_email_loader:bkap_view_view_reminders_param.label.show_sending_test_reminder_email_loader,please_enter_an_email_address:bkap_view_view_reminders_param.label.please_enter_an_email_address,you_provided_invalid_email_address:bkap_view_view_reminders_param.label.you_provided_invalid_email_address},settings:{},reminder_data:{products:[]},wp_editor_data:"",fn:tyche.bkap.metabox.booking},is_edit_mode:!1,show_loading_loader:!1,show_add_edit_reminder_page:!1,show_updating_reminder_loader:!1,show_saving_reminder_loader:!1,show_updating_reminder_loader:!1,show_sending_test_reminder_email_loader:!1}),mounted(){let $this=this;$this.data.settings=bkap_view_view_reminders_param.data,$this.show_loading_loader=!1,$this.data.wp_editor_data=jQuery("#bkap_wp_editor_email_content").html(),tyche.bkap.reminders.table.init($this),setTimeout(function(){tyche.bkap.choices_js.render_choices_js_elements("reminder_selected_products",$this.data.settings.products,".reminder_selected_products",!1,!1)},500)},methods:{close(){jQuery("#reminders-search").trigger("click"),this.show_add_edit_reminder_page=!1},send_test_reminder_email(){const $this=this;tyche.bkap.modal($this.data.settings.send_test_reminder_modal,"Close","Send Reminder",function(){let element=jQuery("input#send_test_reminder_email_address"),email_address=element.val();return void 0===email_address||""===email_address?(element.parent().find("p.error").html($this.data.label.please_enter_an_email_address),!1):email_address.match(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/)?($this.save_update_reminder({send_test_email:"yes",email_address:email_address}),!0):(element.parent().find("p.error").html($this.data.label.you_provided_invalid_email_address),!1)})},save_update_reminder(options={}){const $this=this;let loader=$this.is_edit_mode?"show_updating_reminder_loader":"show_saving_reminder_loader",send_test_email=!1,data=$this.data.reminder_data;data.email_content=jQuery("#email_content_ifr").contents().find("body").html(),void 0!==options.send_test_email&&void 0!==options.email_address&&(send_test_email=!0,data.send_test_email=options.send_test_email,data.email_address=options.email_address,loader="show_sending_test_reminder_email_loader"),$this[loader]=!0,axios.post(`${tyche.bkap.rest_url()}reminders/save-update`,{data:data},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data?"success"===response.data.type?(tyche.bkap.notification(response.data.message,"success"),send_test_email||($this.is_edit_mode=!1,$this.show_add_edit_reminder_page=!1,$this.data.reminder_data={products:[]},setTimeout(function(){tyche.bkap.choices_js.render_choices_js_elements("reminder_selected_products",[],".reminder_selected_products",!1,!1)},500),jQuery("#reminders-search").trigger("click")),$this[loader]=!1):"error"===response.data.type&&(tyche.bkap.notification(response.data.error_description,"alert"),$this[loader]=!1):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error"),"alert"),$this[loader]=!1)}).catch(function(error){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),$this[loader]=!1})}}});
