var create_booking=Vue.component("tab-create-booking",{template:"#create-booking-tab",data:()=>({data:{settings:{done_typing_interval:2e3,typing_timer:{},user_id:"",product_id:"",order_type:"new",show_disabled_dates:"",is_create_booking_post_data:bkap_view_create_booking_param.is_create_booking_post_data},label:{loading_loader:bkap_params.vue.label.loading_loader,create_booking:bkap_view_create_booking_param.label.create_booking,create_booking_description:bkap_view_create_booking_param.label.create_booking_description,create_booking_post_success:"",create_booking_post_error:bkap_view_create_booking_param.create_booking_post_error},fn:{only_numbers:tyche.bkap.metabox.booking.only_numbers}},show_loading_loader:!0,ajax_error:!1,error_message:""}),mounted(){this.init_search_user_select_box(),this.init_search_product_select_box(),this.show_loading_loader=!1;let create_booking_queries=this.$route.query;if("new_booking"in create_booking_queries){switch(create_booking_queries.new_booking){case"success":this.data.label.create_booking_post_success=bkap_view_create_booking_param.label.create_booking_success;break;case"error":this.data.label.create_booking_post_error=bkap_view_create_booking_param.label.create_booking_error}}},methods:{init_search_user_select_box(){let $this=this;tyche.bkap.choices_js.render_choices_js_elements("create_booking_user_search",[],".create_booking_user_search",!0),tyche.bkap.choices_js.instances.create_booking_user_search.passedElement.element.addEventListener("search",function(event){tyche.bkap.choices_js.instances.create_booking_user_search.setChoices([{value:"",label:"Loading...",disabled:!0}],"value","label",!0),clearTimeout($this.data.settings.typing_timer),$this.data.settings.typing_timer=setTimeout(function(){let search_term=event.detail.value;axios.post(`${tyche.bkap.rest_url()}create-booking/search-user`,{search_term:search_term},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data&&"success"===response.data.type&&tyche.bkap.choices_js.render_choices_js_elements("create_booking_user_search",response.data.data,".create_booking_user_search",!0)})},$this.data.settings.done_typing_interval)})},init_search_product_select_box(){let $this=this;tyche.bkap.choices_js.render_choices_js_elements("create_booking_product_search",[],".create_booking_product_search",!0),tyche.bkap.choices_js.instances.create_booking_product_search.passedElement.element.addEventListener("search",function(event){tyche.bkap.choices_js.instances.create_booking_product_search.setChoices([{value:"",label:"Loading...",disabled:!0}],"value","label",!0),clearTimeout($this.data.settings.typing_timer),$this.data.settings.typing_timer=setTimeout(function(){let search_term=event.detail.value;axios.post(`${tyche.bkap.rest_url()}create-booking/search-product`,{search_term:search_term},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data&&"success"===response.data.type&&tyche.bkap.choices_js.render_choices_js_elements("create_booking_product_search",response.data.data,".create_booking_product_search",!0)})},$this.data.settings.done_typing_interval)})},prepare_post_data(){var form_submit=!0;if(""==this.data.settings.user_id&&(this.data.label.create_booking_post_error="Please select user.",form_submit=!1),(form_submit&&null==typeof this.data.settings.product_id||"undefined"==this.data.settings.product_id||""==this.data.settings.product_id)&&(this.data.label.create_booking_post_error="Please select product.",form_submit=!1),form_submit&&"existing"==this.data.settings.order_type&&""==this.data.settings.existing_order_id&&(this.data.label.create_booking_post_error="Please add Order ID.",form_submit=!1),form_submit){this.show_loading_loader=!0;let form=document.createElement("form");form.method="POST";let input=document.createElement("input");input.type="hidden",input.name="create_booking_post_data[user_id]",input.value=this.data.settings.user_id,form.appendChild(input),input=document.createElement("input"),input.type="hidden",input.name="create_booking_post_data[product_id]",input.value=this.data.settings.product_id,form.appendChild(input),input=document.createElement("input"),input.name="create_booking_post_data[order_type]",input.value=this.data.settings.order_type,form.appendChild(input),input=document.createElement("input"),input.name="create_booking_post_data[show_disabled_dates]",input.value=this.data.settings.show_disabled_dates,form.appendChild(input),"existing"!==this.data.settings.order_type&&"only_booking"!==this.data.settings.order_type||(input=document.createElement("input"),input.name="create_booking_post_data[existing_order_id]","only_booking"===this.data.settings.order_type?input.value="only_booking":input.value=this.data.settings.existing_order_id,form.appendChild(input)),document.body.appendChild(form),form.submit()}else document.getElementById("bkap-page").scrollIntoView({behavior:"smooth",block:"start"})}}});
