var product_availability_settings=Vue.component("tab-product-availability",{template:"#product-availability-tab",data:()=>({data:tyche.bkap.merge(bkap_view_product_availability_settings_param.data,{fn:{validate_timeslot_from_to:tyche.bkap.metabox.booking.validate_weekday_date_timeslots_from_or_to,only_numbers:tyche.bkap.metabox.booking.only_numbers,initialize_datepicker:tyche.bkap.metabox.booking.initialize_datepicker}}),show_executing_action_loader:!1}),mounted(){let $this=this;$this.data.settings.action_data=[{day_date:"day",days_dates:[],selectedDate:"",action:"add",from_time:"",to_time:"",max_booking:"",price:"",note:""}],setTimeout(function(){tyche.bkap.choices_js.render_choices_js_elements("product_availability_settings_selected_products",[],".product_availability_settings_selected_products",!1,!1),tyche.bkap.choices_js.render_choices_js_elements("bkap_choices_js_product_availability_days_dates",$this.data.list.days_dates,".bkap_choices_js_product_availability_days_dates",!1,!1)},500)},methods:{set_dates:function($event,index){this.data.settings.action_data[index].selectedDate=$event.target.value},add_row:function(){let $this=this,count=Object.keys($this.data.settings.action_data).length;$this.data.settings.action_data.push({day_date:"day",days_dates:[],selectedDate:"",action:"add",from_time:"",to_time:"",max_booking:"",price:"",note:""}),setTimeout(function(){tyche.bkap.choices_js.render_choices_js_elements("bkap_choices_js_product_availability_days_dates_"+count,$this.data.list.days_dates,"#bkap_choices_js_product_availability_days_dates_"+count,!1,!1)},50)},delete_row:function(index){this.data.settings.action_data.splice(index,1),void 0!==tyche.bkap.choices_js.instances[`bkap_choices_js_product_availability_days_dates_${index}`]&&delete tyche.bkap.choices_js.instances[`bkap_choices_js_product_availability_days_dates_${index}`]},execute_added_action:function(){let $this=this;for(data of $this.data.settings.action_data)if("day"===data.day_date?Array.isArray(data.days_dates)&&0===data.days_dates.length:""===data.days_dates)return void tyche.bkap.alert.error("Some errors have been found!",$this.data.validation_messages.some_fields_are_empty);$this.show_executing_action_loader=!0,axios.post(`${tyche.bkap.rest_url()}product-availability-settings/execute-added-action`,{data:$this.data.settings},{headers:{"X-WP-Nonce":bkap_params.nonce}}).then(function(response){void 0!==response.data.type&&"success"===response.data.type?(tyche.bkap.choices_js.instances.product_availability_settings_selected_products.removeActiveItems(),tyche.bkap.notification(response.data.message,"success"),$this.data.settings.product_id=[],$this.data.settings.action_data=[],$this.show_executing_action_loader=!1):(tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),$this.show_executing_action_loader=!1)}).catch(function(){tyche.bkap.notification(tyche.bkap.return_label("axios_get_error",error),"alert"),$this.show_executing_action_loader=!1})}}});
