function bkap_ad(dateObj,numDays){return dateObj.setDate(dateObj.getDate()+numDays)}function bkap_gd(date1,date2,interval){date1=new Date(date1).getTime();var timediff=(date2="now"==date2?(new Date).getTime():new Date(date2).getTime())-date1;if(isNaN(timediff))return NaN;switch(interval){case"years":return date2.getFullYear()-date1.getFullYear();case"months":return 12*date2.getFullYear()+date2.getMonth()-(12*date1.getFullYear()+date1.getMonth());case"weeks":return Math.floor(timediff/6048e5);case"days":return Math.floor(timediff/864e5);case"hours":return Math.floor(timediff/36e5);case"minutes":return Math.floor(timediff/6e4);case"seconds":return Math.floor(timediff/1e3);default:return}}function bkap_nd(date){var settings=JSON.parse(bkap_init_params.additional_data),labels=JSON.parse(bkap_init_params.labels),m=date.getMonth(),d=date.getDate(),y=date.getFullYear(),bkap_holiday_dates=JSON.parse("["+settings.holidays+"]");for(ii=0;ii<bkap_holiday_dates.length;ii++)if(-1!=jQuery.inArray(d+"-"+(m+1)+"-"+y,bkap_holiday_dates))return[!1,"bkap-holiday-date",labels.holiday_label];return[!0]}function bkap_sp(date){var m=date.getMonth(),d=date.getDate(),y=date.getFullYear(),settings=JSON.parse(bkap_init_params.additional_data),bkap_specific_dates=JSON.parse("["+settings.specific_dates+"]");for(ii=0;ii<bkap_specific_dates.length;ii++)if(-1!=jQuery.inArray(d+"-"+(m+1)+"-"+y,bkap_specific_dates))return[!0];return[!1]}function fixed_range(date,id_booking){var settings=JSON.parse(bkap_init_params.additional_data),dt=(date.getMonth(),date.getDate(),date.getFullYear(),new Date),FixedRangeDates=(dt.getMonth(),dt.getDate(),dt.getFullYear(),JSON.parse("["+settings.fixed_ranges+"]")),in_range=!1;for(i=0;i<FixedRangeDates.length;){var j=i,range_start=FixedRangeDates[j],range_end=FixedRangeDates[j+1],split_start_1=range_start.split("-"),split_end_1=range_end.split("-"),start_date1=new Date(split_start_1[1]+"/"+split_start_1[0]+"/"+split_start_1[2]);start_new=start_date1.getMonth()+1+"/"+start_date1.getDate()+"/"+start_date1.getFullYear();var end_date1=new Date(split_end_1[1]+"/"+split_end_1[0]+"/"+split_end_1[2]);end_new=end_date1.getMonth()+1+"/"+end_date1.getDate()+"/"+end_date1.getFullYear();var start_range=new Date(start_new),end_date=new Date(end_new);!id_booking||"booking_calender_checkout"!=id_booking&&"inline_calendar_checkout"!=id_booking||end_date.setDate(end_date.getDate()+1);var end_range=new Date(end_date.getTime());end_range.setDate(end_range.getDate()+1),date>=start_range&&date<end_range&&(in_range=!0),i+=2}return 1==in_range}function bkap_avd(date){var settings=JSON.parse(bkap_init_params.additional_data);if(void 0!==settings.fixed_ranges){var split_date=settings.min_date.split("-"),start_day=new Date(split_date[1]+"/"+split_date[0]+"/"+split_date[2]),split_date_end=(end_date=settings.number_of_dates).split("-"),end_day=new Date(split_date_end[1]+"/"+split_date_end[0]+"/"+split_date_end[2]);return isNaN(start_day)&&(start_day=new Date),start=start_day.getMonth()+1+"/"+start_day.getDate()+"/"+start_day.getFullYear(),end=end_day.getMonth()+1+"/"+end_day.getDate()+"/"+end_day.getFullYear(),{minDate:new Date(start),maxDate:new Date(end)}}{var bkap_settings=JSON.parse(bkap_init_params.bkap_settings),delay_days=(split_date=settings.min_date.split("-"),new Date(split_date[1]+"/"+split_date[0]+"/"+split_date[2])),no_of_dates_to_show=parseInt(settings.number_of_dates),recurring_days=bkap_settings.booking_recurring_booking,specific_dates=bkap_settings.booking_specific_booking,weekdays=bkap_settings.booking_recurring,all_weekdays_disabled=!0;for(iii=0;iii<=6;iii++)if(day="booking_weekday_"+iii,"on"===weekdays[day]){all_weekdays_disabled=!1;break}isNaN(delay_days)&&(delay_days=new Date),isNaN(no_of_dates_to_show)&&(no_of_dates_to_show=30);var today=new Date;delay_days.setHours(0,0,0,0),today.setHours(0,0,0,0);var bkap_split_first_date=settings.default_date.split("-"),bkap_first_available_date_obj=new Date(bkap_split_first_date[1]+"/"+bkap_split_first_date[0]+"/"+bkap_split_first_date[2]);let start=bkap_first_available_date_obj.getMonth()+1+"/"+bkap_first_available_date_obj.getDate()+"/"+bkap_first_available_date_obj.getFullYear();var end_date=settings.bkap_no_of_days_count_from_current_day?new Date(bkap_ad(delay_days,no_of_dates_to_show)):new Date(bkap_ad(bkap_first_available_date_obj,no_of_dates_to_show));end=end_date.getMonth()+1+"/"+end_date.getDate()+"/"+end_date.getFullYear();var specific_max_date=start,specific_max_date_obj=bkap_first_available_date_obj;if(!1!==settings.specific_dates){var bkap_specific_dates=JSON.parse("["+settings.specific_dates+"]");let si=0;for(""==recurring_days&&bkap_specific_dates.length>0&&no_of_dates_to_show>bkap_specific_dates.length&&(no_of_dates_to_show=bkap_specific_dates.length),ii=0;ii<bkap_specific_dates.length;ii++){var split=bkap_specific_dates[ii].split("-"),specific_date=split[1]+"/"+split[0]+"/"+split[2],diff=bkap_gd(specific_max_date,specific_date,"days");if(diff>=0&&(specific_max_date=specific_date,specific_max_date_obj=new Date(specific_date)),si==no_of_dates_to_show)break;si++}}var loopCounter=bkap_gd(start,end,"days");let date_counts=1;if("on"==specific_dates&&null!=bkap_specific_dates&&0!=bkap_specific_dates.length&&(diff=bkap_gd(end,specific_max_date,"days"))>=0&&(loopCounter=bkap_gd(start,specific_max_date,"days")),loopCounter>1){var l_end=new Date(end);let new_date=new Date(start);for(var i=0;i<=loopCounter;i++){if(bkap_nd(new_date)[0]){if(day="booking_weekday_"+new_date.getDay(),day_check=weekdays[day],is_specific=bkap_sp(new_date),is_specific[0]||"on"==day_check){if(date_counts==no_of_dates_to_show){l_end=new_date;break}date_counts++,new_date=new Date(bkap_ad(new_date,1))}else new_date=new Date(bkap_ad(new_date,1)),""!=recurring_days&&!1===all_weekdays_disabled&&loopCounter++;if(end_date.getTime()<specific_max_date_obj.getTime()&&new_date.getTime()===specific_max_date_obj.getTime()&&(l_end=new_date,date_counts==no_of_dates_to_show))break;if(1e3==i){console.error("Stopped due to infinite loop. Please contact Booking plugin support.");break}}else new_date=new Date(bkap_ad(new_date,1)),loopCounter++}}else 0!==loopCounter&&1!==loopCounter||(l_end=new Date(start));return{minDate:new Date(start),maxDate:l_end}}}
